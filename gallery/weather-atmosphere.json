{
  "id": "weather-atmosphere",
  "name": "Atmosphere",
  "description": "Get real-time weather updates for your location.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"widget-card\" id=\"main-card\">\n  \n  <div class=\"header\">\n    <div class=\"location-group\">\n      <span class=\"pin-icon\">üìç</span>\n      <span id=\"city-name\" class=\"city-name\">Locating...</span>\n    </div>\n    <button id=\"btn-search\" class=\"icon-btn\">üîç</button>\n  </div>\n\n  \n  <div id=\"search-panel\" class=\"search-overlay hidden\">\n    <div class=\"search-box\">\n      <input type=\"text\" id=\"inp-city\" placeholder=\"City name (e.g. Tokyo)\">\n      <div class=\"search-actions\">\n        <button id=\"btn-go\" class=\"btn-primary\">Search</button>\n        <button id=\"btn-cancel\" class=\"btn-sec\">Cancel</button>\n      </div>\n      <div id=\"search-status\" class=\"status-msg\"></div>\n    </div>\n  </div>\n\n  \n  <div class=\"current-weather\">\n    <div class=\"icon-area\" id=\"weather-icon\">‚òÄÔ∏è</div>\n    <div class=\"temp-area\">\n      <span id=\"temp-val\">--</span><span class=\"unit\">¬∞</span>\n    </div>\n    <div class=\"condition\" id=\"condition-text\">Loading</div>\n  </div>\n\n  \n  <div class=\"details-row\">\n    <div class=\"detail\">\n      <span class=\"lbl\">Wind</span>\n      <span class=\"val\" id=\"wind-val\">--</span>\n    </div>\n    <div class=\"detail\">\n      <span class=\"lbl\">Humidity</span>\n      <span class=\"val\" id=\"hum-val\">--</span>\n    </div>\n  </div>\n\n  \n  <div class=\"forecast-row\" id=\"forecast-container\">\n    \n  </div>\n\n  <div class=\"footer-update\">\n    <span id=\"last-update\">Updated: Just now</span>\n    <button id=\"btn-refresh\" class=\"refresh-btn\">‚Üª</button>\n  </div>\n</div>",
  "css": ":host { display: block; margin: 1rem 0; font-family: var(--font-interface); } * { box-sizing: border-box; } .widget-card { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; border-radius: 24px; padding: 1.5rem; box-shadow: var(--shadow-l); max-width: 360px; margin: 0 auto; position: relative; overflow: hidden; transition: background 0.5s ease; } /* Dynamic Backgrounds */ .bg-sunny { background: linear-gradient(135deg, #f59e0b, #ea580c); } .bg-cloudy { background: linear-gradient(135deg, #64748b, #475569); } .bg-rain { background: linear-gradient(135deg, #374151, #1f2937); } .bg-night { background: linear-gradient(135deg, #0f172a, #1e293b); } .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; } .location-group { display: flex; align-items: center; gap: 6px; font-weight: 700; font-size: 1rem; text-transform: uppercase; letter-spacing: 0.5px; } .icon-btn { background: rgba(255,255,255,0.2); border: none; width: 32px; height: 32px; border-radius: 50%; color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s; } .icon-btn:hover { background: rgba(255,255,255,0.4); } .current-weather { text-align: center; margin: 1.5rem 0; } .icon-area { font-size: 4rem; margin-bottom: 0.5rem; filter: drop-shadow(0 4px 10px rgba(0,0,0,0.2)); animation: float 3s ease-in-out infinite; } @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } } .temp-area { font-size: 3.5rem; font-weight: 800; line-height: 1; } .unit { font-size: 1.5rem; vertical-align: top; opacity: 0.8; } .condition { font-size: 1rem; font-weight: 600; opacity: 0.9; text-transform: capitalize; margin-top: 4px; } .details-row { display: flex; justify-content: space-around; background: rgba(255,255,255,0.15); border-radius: 12px; padding: 10px; margin-bottom: 1.5rem; backdrop-filter: blur(4px); } .detail { display: flex; flex-direction: column; align-items: center; } .lbl { font-size: 0.65rem; text-transform: uppercase; opacity: 0.8; } .val { font-size: 0.9rem; font-weight: 700; } .forecast-row { display: flex; justify-content: space-between; margin-top: 1rem; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 1rem; } .day-col { display: flex; flex-direction: column; align-items: center; gap: 4px; } .day-name { font-size: 0.75rem; font-weight: 700; opacity: 0.8; } .day-icon { font-size: 1.2rem; } .day-temp { font-size: 0.9rem; font-weight: 700; } .footer-update { display: flex; justify-content: space-between; align-items: center; margin-top: 1rem; font-size: 0.7rem; opacity: 0.6; } .refresh-btn { background: none; border: none; color: white; cursor: pointer; font-size: 1rem; transition: transform 0.5s; } .refresh-btn:hover { transform: rotate(180deg); } /* Search Overlay */ .search-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.85); z-index: 10; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.2s; backdrop-filter: blur(5px); } .search-overlay:not(.hidden) { opacity: 1; pointer-events: all; } .search-box { background: white; padding: 1.5rem; border-radius: 16px; width: 85%; color: #1e293b; text-align: center; } .search-box input { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 1rem; margin-bottom: 10px; outline: none; } .search-actions { display: flex; gap: 8px; } .search-actions button { flex: 1; padding: 8px; border-radius: 8px; border: none; font-weight: 700; cursor: pointer; } .btn-primary { background: #3b82f6; color: white; } .btn-sec { background: #e2e8f0; color: #475569; } .status-msg { margin-top: 8px; font-size: 0.8rem; color: #ef4444; min-height: 1.2em; }",
  "js": "var root = api.root;\nvar saveState = api.saveState;\nvar getState = api.getState;\n\nvar state = {\n  city: 'Paris',\n  lat: 48.8566,\n  lon: 2.3522,\n  lastFetch: 0,\n  data: null\n};\n\nfunction getIcon(code, isDay) {\n  // WMO Weather Codes\n  if(code === 0) return isDay ? '‚òÄÔ∏è' : 'üåô';\n  if(code >= 1 && code <= 3) return isDay ? '‚õÖ' : '‚òÅÔ∏è';\n  if(code >= 45 && code <= 48) return 'üå´Ô∏è';\n  if(code >= 51 && code <= 67) return 'üåßÔ∏è';\n  if(code >= 71 && code <= 77) return '‚ùÑÔ∏è';\n  if(code >= 80 && code <= 82) return 'üåßÔ∏è';\n  if(code >= 95) return '‚õàÔ∏è';\n  return 'üå°Ô∏è';\n}\n\nfunction getThemeClass(code, isDay) {\n  if(!isDay) return 'bg-night';\n  if(code <= 1) return 'bg-sunny';\n  if(code <= 48) return 'bg-cloudy';\n  return 'bg-rain';\n}\n\nfunction render() {\n  root.getElementById('city-name').innerText = state.city;\n  \n  if (!state.data) return;\n  \n  var current = state.data.current;\n  var daily = state.data.daily;\n  \n  // Current\n  var code = current.weather_code;\n  var isDay = current.is_day === 1;\n  \n  root.getElementById('temp-val').innerText = Math.round(current.temperature_2m);\n  root.getElementById('condition-text').innerText = 'Code ' + code;\n  root.getElementById('wind-val').innerText = current.wind_speed_10m + ' km/h';\n  root.getElementById('hum-val').innerText = current.relative_humidity_2m + '%';\n  \n  // Icon & Theme\n  root.getElementById('weather-icon').innerText = getIcon(code, isDay);\n  var card = root.getElementById('main-card');\n  card.className = 'widget-card ' + getThemeClass(code, isDay);\n  \n  // Forecast (Next 3 Days)\n  var forecastHtml = '';\n  // We skip index 0 because it is today, we want next days\n  for(var i=1; i<=3; i++) {\n      var date = new Date(daily.time[i]);\n      var dayName = date.toLocaleDateString('en-US', { weekday: 'short' });\n      var maxTemp = Math.round(daily.temperature_2m_max[i]);\n      var dCode = daily.weather_code[i];\n      var dIcon = getIcon(dCode, true);\n      \n      forecastHtml += '<div class=\"day-col\">' +\n        '<span class=\"day-name\">' + dayName + '</span>' +\n        '<span class=\"day-icon\">' + dIcon + '</span>' +\n        '<span class=\"day-temp\">' + maxTemp + '¬∞</span>' +\n      '</div>';\n  }\n  root.getElementById('forecast-container').innerHTML = forecastHtml;\n  \n  // Update Time\n  var d = new Date(state.lastFetch);\n  root.getElementById('last-update').innerText = 'Updated: ' + d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});\n}\n\nfunction fetchData() {\n  var url = 'https://api.open-meteo.com/v1/forecast?latitude=' + state.lat + '&longitude=' + state.lon + '&current=temperature_2m,relative_humidity_2m,is_day,weather_code,wind_speed_10m&daily=weather_code,temperature_2m_max&timezone=auto';\n  \n  root.getElementById('condition-text').innerText = 'Updating...';\n  \n  fetch(url).then(function(r){ return r.json(); }).then(function(data) {\n      state.data = data;\n      state.lastFetch = Date.now();\n      render();\n      saveState(state);\n  }).catch(function(e) {\n      root.getElementById('condition-text').innerText = 'Error';\n  });\n}\n\nfunction searchCity() {\n  var input = root.getElementById('inp-city');\n  var msg = root.getElementById('search-status');\n  var query = input.value.trim();\n  \n  if(!query) return;\n  msg.innerText = 'Searching...';\n  \n  var url = 'https://geocoding-api.open-meteo.com/v1/search?name=' + query + '&count=1&language=en&format=json';\n  \n  fetch(url).then(function(r){ return r.json(); }).then(function(data) {\n      if(data.results && data.results.length > 0) {\n          var res = data.results[0];\n          state.city = res.name;\n          state.lat = res.latitude;\n          state.lon = res.longitude;\n          toggleSearch(false);\n          msg.innerText = '';\n          fetchData();\n      } else {\n          msg.innerText = 'City not found.';\n      }\n  }).catch(function() {\n      msg.innerText = 'Network error.';\n  });\n}\n\nfunction toggleSearch(show) {\n  var el = root.getElementById('search-panel');\n  if(show) {\n      el.classList.remove('hidden');\n      root.getElementById('inp-city').focus();\n  } else {\n      el.classList.add('hidden');\n  }\n}\n\nasync function init() {\n  var saved = await getState();\n  if (saved) state = saved;\n  \n  render();\n  \n  // Auto-fetch if data is older than 1 hour or missing\n  if(!state.data || (Date.now() - state.lastFetch > 3600000)) {\n      fetchData();\n  }\n  \n  root.getElementById('btn-search').onclick = function() { toggleSearch(true); };\n  root.getElementById('btn-cancel').onclick = function() { toggleSearch(false); };\n  root.getElementById('btn-go').onclick = searchCity;\n  root.getElementById('btn-refresh').onclick = fetchData;\n  \n  // Enter key support\n  root.getElementById('inp-city').onkeydown = function(e) {\n      if(e.key === 'Enter') searchCity();\n  };\n}\n\ninit();",
  "tags": [
    "weather",
    "live",
    "forecast",
    "dashboard"
  ]
}
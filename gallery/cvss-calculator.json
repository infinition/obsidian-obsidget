{
  "id": "cvss-calculator",
  "name": "CVSS Calculator",
  "description": "Calculate CVSS v3.1 scores for security vulnerabilities.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"cvss-widget\">\n  <div class=\"widget-header\">\n    <h4 class=\"widget-title\">üõ°Ô∏è CVSS v3.1 Studio</h4>\n    <div class=\"header-actions\">\n      <button class=\"btn-icon\" id=\"btn-copy-vector\" title=\"Copy Vector\">üìã</button>\n      <button class=\"btn-icon\" id=\"btn-reset\" title=\"Reset\">‚Ü∫</button>\n    </div>\n  </div>\n\n  <div class=\"score-hero\" id=\"score-hero\">\n    <div class=\"score-main\">\n      <span class=\"score-value\" id=\"cvss-score\">0.0</span>\n      <span class=\"score-label\">Base Score</span>\n    </div>\n    <div class=\"severity-badge\" id=\"severity\">None</div>\n  </div>\n\n  <div class=\"vector-bar\" id=\"vector-display\">CVSS:3.1/AV:_/AC:_/PR:_/UI:_/S:_/C:_/I:_/A:_</div>\n\n  <div class=\"metrics-container\">\n    <div class=\"metric-group\">\n      <div class=\"group-title\">Exploitability Metrics</div>\n      <div class=\"metric-row\">\n        <label>Attack Vector (AV)</label>\n        <select id=\"AV\" class=\"cvss-select\">\n          <option value=\"0.85\">Network (N)</option>\n          <option value=\"0.62\">Adjacent (A)</option>\n          <option value=\"0.55\">Local (L)</option>\n          <option value=\"0.2\">Physical (P)</option>\n        </select>\n      </div>\n      <div class=\"metric-row\">\n        <label>Attack Complexity (AC)</label>\n        <select id=\"AC\" class=\"cvss-select\">\n          <option value=\"0.77\">Low (L)</option>\n          <option value=\"0.44\">High (H)</option>\n        </select>\n      </div>\n      <div class=\"metric-row\">\n        <label>Privileges Required (PR)</label>\n        <select id=\"PR\" class=\"cvss-select\">\n          <option value=\"0.85\">None (N)</option>\n          <option value=\"0.62\">Low (L)</option>\n          <option value=\"0.27\">High (H)</option>\n        </select>\n      </div>\n      <div class=\"metric-row\">\n        <label>User Interaction (UI)</label>\n        <select id=\"UI\" class=\"cvss-select\">\n          <option value=\"0.85\">None (N)</option>\n          <option value=\"0.62\">Required (R)</option>\n        </select>\n      </div>\n    </div>\n\n    <div class=\"metric-group\">\n      <div class=\"group-title\">Impact Metrics</div>\n      <div class=\"metric-row\">\n        <label>Scope (S)</label>\n        <select id=\"S\" class=\"cvss-select\">\n          <option value=\"U\">Unchanged (U)</option>\n          <option value=\"C\">Changed (C)</option>\n        </select>\n      </div>\n      <div class=\"metric-row\">\n        <label>Confidentiality (C)</label>\n        <select id=\"C\" class=\"cvss-select\">\n          <option value=\"0.56\">High (H)</option>\n          <option value=\"0.22\">Low (L)</option>\n          <option value=\"0\">None (N)</option>\n        </select>\n      </div>\n      <div class=\"metric-row\">\n        <label>Integrity (I)</label>\n        <select id=\"I\" class=\"cvss-select\">\n          <option value=\"0.56\">High (H)</option>\n          <option value=\"0.22\">Low (L)</option>\n          <option value=\"0\">None (N)</option>\n        </select>\n      </div>\n      <div class=\"metric-row\">\n        <label>Availability (A)</label>\n        <select id=\"A\" class=\"cvss-select\">\n          <option value=\"0.56\">High (H)</option>\n          <option value=\"0.22\">Low (L)</option>\n          <option value=\"0\">None (N)</option>\n        </select>\n      </div>\n    </div>\n  </div>\n  \n  <div id=\"toast\" class=\"toast\">Copied!</div>\n</div>",
  "css": ":host { display: block; font-family: var(--font-interface); }\n* { box-sizing: border-box; }\n\n.cvss-widget {\n    background: var(--background-secondary);\n    border: 1px solid var(--background-modifier-border);\n    border-radius: 16px;\n    padding: 1.25rem;\n    color: var(--text-normal);\n    box-shadow: var(--shadow-s);\n    width: 100%;\n}\n\n.widget-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n}\n\n.widget-title {\n    margin: 0;\n    font-size: 0.85rem;\n    font-weight: 600;\n    color: var(--text-muted);\n    text-transform: uppercase;\n    letter-spacing: 0.1em;\n}\n\n.header-actions { display: flex; gap: 8px; }\n.btn-icon {\n    background: var(--background-primary);\n    border: 1px solid var(--background-modifier-border);\n    color: var(--text-muted);\n    width: 28px;\n    height: 28px;\n    border-radius: 6px;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 0.9rem;\n    transition: all 0.2s;\n}\n.btn-icon:hover { background: var(--background-modifier-hover); color: var(--interactive-accent); }\n\n.score-hero {\n    background: var(--background-primary);\n    border-radius: 12px;\n    padding: 1.5rem;\n    border: 1px solid var(--background-modifier-border);\n    text-align: center;\n    margin-bottom: 1rem;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 8px;\n    transition: all 0.3s ease;\n}\n\n.score-main {\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n}\n\n.score-value {\n    font-size: 3rem;\n    font-weight: 900;\n    color: var(--interactive-accent);\n}\n\n.score-label {\n    font-size: 0.65rem;\n    color: var(--text-muted);\n    text-transform: uppercase;\n    font-weight: 700;\n    letter-spacing: 0.05em;\n}\n\n.severity-badge {\n    padding: 4px 12px;\n    border-radius: 20px;\n    font-size: 0.7rem;\n    font-weight: 800;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n    background: var(--background-secondary);\n    color: var(--text-muted);\n}\n\n.vector-bar {\n    background: var(--background-secondary-alt);\n    border: 1px solid var(--background-modifier-border);\n    border-radius: 8px;\n    padding: 8px 12px;\n    font-family: var(--font-monospace);\n    font-size: 0.7rem;\n    color: var(--text-muted);\n    text-align: center;\n    margin-bottom: 1.5rem;\n    word-break: break-all;\n}\n\n.metrics-container {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1.5rem;\n}\n\n@media (max-width: 400px) {\n    .metrics-container { grid-template-columns: 1fr; }\n}\n\n.metric-group {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n}\n\n.group-title {\n    font-size: 0.7rem;\n    font-weight: 700;\n    color: var(--text-accent);\n    text-transform: uppercase;\n    margin-bottom: 4px;\n    border-bottom: 1px solid var(--background-modifier-border);\n    padding-bottom: 4px;\n}\n\n.metric-row {\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n}\n\n.metric-row label {\n    font-size: 0.65rem;\n    font-weight: 600;\n    color: var(--text-muted);\n}\n\n.cvss-select {\n    background: var(--background-primary);\n    border: 1px solid var(--background-modifier-border);\n    color: var(--text-normal);\n    border-radius: 6px;\n    padding: 6px 8px;\n    font-size: 0.8rem;\n    outline: none;\n    cursor: pointer;\n}\n.cvss-select:focus { border-color: var(--interactive-accent); }\n\n.toast {\n    position: fixed;\n    bottom: 20px;\n    left: 50%;\n    transform: translateX(-50%) translateY(100px);\n    background: var(--interactive-accent);\n    color: var(--text-on-accent);\n    padding: 8px 16px;\n    border-radius: 20px;\n    font-size: 0.8rem;\n    font-weight: 600;\n    transition: transform 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28);\n    z-index: 100;\n}\n.toast.show { transform: translateX(-50%) translateY(0); }",
  "js": "const { root, saveState, getState } = api;\n\nconst METRICS = ['AV', 'AC', 'PR', 'UI', 'S', 'C', 'I', 'A'];\n\nfunction getVal(id) {\n    const el = root.getElementById(id);\n    return el ? el.value : '0';\n}\n\nfunction roundup(input) {\n    const int_input = Math.round(input * 100000);\n    if (int_input % 10000 === 0) return int_input / 100000;\n    return (Math.floor(int_input / 10000) + 1) / 10;\n}\n\nfunction calculate() {\n    const av = parseFloat(getVal('AV'));\n    const ac = parseFloat(getVal('AC'));\n    const pr_val = getVal('PR');\n    const ui = parseFloat(getVal('UI'));\n    const s = getVal('S');\n    const c = parseFloat(getVal('C'));\n    const i = parseFloat(getVal('I'));\n    const a = parseFloat(getVal('A'));\n\n    let pr = parseFloat(pr_val);\n    if (s === 'C') {\n        if (pr_val === '0.62') pr = 0.68;\n        if (pr_val === '0.27') pr = 0.5;\n    }\n\n    const iss = 1 - ((1 - c) * (1 - i) * (1 - a));\n    let impact = 0;\n    if (s === 'U') {\n        impact = 6.42 * iss;\n    } else {\n        impact = 7.52 * (iss - 0.029) - 3.25 * Math.pow(iss - 0.02, 15);\n    }\n\n    const exploitability = 8.22 * av * ac * pr * ui;\n    \n    let baseScore = 0;\n    if (impact > 0) {\n        if (s === 'U') {\n            baseScore = roundup(Math.min(impact + exploitability, 10));\n        } else {\n            baseScore = roundup(Math.min(1.08 * (impact + exploitability), 10));\n        }\n    }\n\n    updateUI(baseScore.toFixed(1));\n    save();\n}\n\nfunction updateUI(score) {\n    const scoreEl = root.getElementById('cvss-score');\n    const sevEl = root.getElementById('severity');\n    if (!scoreEl || !sevEl) return;\n    \n    scoreEl.innerText = score;\n    \n    let sev = 'None';\n    let color = 'var(--text-muted)';\n    let bg = 'var(--background-secondary)';\n\n    const s = parseFloat(score);\n    if (s >= 9.0) { sev = 'Critical'; color = '#ffffff'; bg = '#cc0000'; }\n    else if (s >= 7.0) { sev = 'High'; color = '#ffffff'; bg = '#ff4400'; }\n    else if (s >= 4.0) { sev = 'Medium'; color = '#ffffff'; bg = '#ffbb33'; }\n    else if (s >= 0.1) { sev = 'Low'; color = '#ffffff'; bg = '#00c851'; }\n\n    sevEl.innerText = sev;\n    sevEl.style.backgroundColor = bg;\n    sevEl.style.color = color;\n    \n    const vector = `CVSS:3.1/AV:${getShort('AV')}/AC:${getShort('AC')}/PR:${getShort('PR')}/UI:${getShort('UI')}/S:${getVal('S')}/C:${getShort('C')}/I:${getShort('I')}/A:${getShort('A')}`;\n    const vecEl = root.getElementById('vector-display');\n    if (vecEl) vecEl.innerText = vector;\n}\n\nfunction getShort(id) {\n    const el = root.getElementById(id);\n    if (!el) return '_';\n    const text = el.options[el.selectedIndex].text;\n    const match = text.match(/\\(([A-Z])\\)/);\n    return match ? match[1] : '_';\n}\n\nfunction copyVector() {\n    const vecEl = root.getElementById('vector-display');\n    if (!vecEl) return;\n    const vector = vecEl.innerText;\n    navigator.clipboard.writeText(vector);\n    showToast();\n}\n\nfunction showToast() {\n    const toast = root.getElementById('toast');\n    if (!toast) return;\n    toast.classList.add('show');\n    setTimeout(() => toast.classList.remove('show'), 2000);\n}\n\nfunction reset() {\n    METRICS.forEach(m => {\n        const el = root.getElementById(m);\n        if (el) el.selectedIndex = 0;\n    });\n    calculate();\n}\n\nfunction save() {\n    const state = {};\n    METRICS.forEach(m => {\n        const el = root.getElementById(m);\n        if (el) state[m] = el.value;\n    });\n    saveState(state);\n}\n\nasync function init() {\n    const saved = await getState();\n    METRICS.forEach(m => {\n        const el = root.getElementById(m);\n        if (!el) return;\n        if (saved && saved[m]) el.value = saved[m];\n        el.onchange = calculate;\n    });\n\n    const copyBtn = root.getElementById('btn-copy-vector');\n    if (copyBtn) copyBtn.onclick = copyVector;\n    \n    const resetBtn = root.getElementById('btn-reset');\n    if (resetBtn) resetBtn.onclick = reset;\n\n    calculate();\n}\n\ninit();",
  "tags": [
    "security",
    "calculator",
    "cybersecurity",
    "cvss"
  ]
}
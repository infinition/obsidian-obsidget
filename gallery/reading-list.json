{
  "id": "reading-list",
  "name": "Reading List",
  "description": "Track your reading progress and manage your book collection.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"widget-card\">\n  <div class=\"widget-header\">\n    <div class=\"header-left\">\n      <span class=\"widget-icon\">üìö</span>\n      <h4 class=\"widget-title\">Reading List Pro</h4>\n    </div>\n    <button class=\"btn-add\" id=\"btn-add\" title=\"Add New Book\">+</button>\n  </div>\n\n  <div class=\"book-grid\" id=\"book-grid\">\n    <!-- Dynamic book cards -->\n  </div>\n\n  <div class=\"stats-row\">\n    <div class=\"stat-item\">\n      <span class=\"stat-val\" id=\"books-read\">0</span>\n      <label class=\"stat-lbl\">Finished</label>\n    </div>\n    <div class=\"stat-item\">\n      <span class=\"stat-val\" id=\"pages-total\">0</span>\n      <label class=\"stat-lbl\">Pages Read</label>\n    </div>\n  </div>\n\n  <!-- Detail/Update Overlay -->\n  <div class=\"overlay\" id=\"detail-overlay\">\n    <div class=\"overlay-content\">\n      <div class=\"overlay-header\">\n        <h3 id=\"detail-title\">Book Title</h3>\n        <div class=\"header-btns\">\n          <button class=\"btn-icon-small\" id=\"btn-edit-book\" title=\"Edit Details\">‚úèÔ∏è</button>\n          <button class=\"btn-close\" id=\"btn-close-detail\">‚úï</button>\n        </div>\n      </div>\n      \n      <div class=\"detail-body\">\n        <div class=\"detail-main-info\">\n            <div id=\"detail-cover-container\" class=\"detail-cover\"></div>\n            <div class=\"progress-visual\">\n              <svg viewBox=\"0 0 36 36\" class=\"circular-chart\">\n                <path class=\"circle-bg\" d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\" />\n                <path id=\"detail-circle\" class=\"circle\" stroke-dasharray=\"0, 100\" d=\"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831\" />\n                <text x=\"18\" y=\"20.35\" class=\"percentage\" id=\"detail-percent\">0%</text>\n              </svg>\n            </div>\n        </div>\n\n        <div class=\"progress-controls\">\n          <div class=\"input-group\">\n            <label>Current Progress</label>\n            <div class=\"slider-container\">\n              <input type=\"range\" id=\"input-slider\" min=\"0\" max=\"100\" value=\"0\" class=\"range-slider\">\n            </div>\n            <div class=\"number-input-row\">\n              <div class=\"number-input\">\n                <button class=\"step-btn\" id=\"btn-step-minus\">-</button>\n                <input type=\"number\" id=\"input-current-page\" value=\"0\">\n                <button class=\"step-btn\" id=\"btn-step-plus\">+</button>\n              </div>\n              <span class=\"total-pages-label\" id=\"detail-total-pages\">/ 300p</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"overlay-actions\">\n        <button class=\"btn-delete-book\" id=\"btn-delete-book\">Delete</button>\n        <button class=\"btn-save-progress\" id=\"btn-save-progress\">Update</button>\n      </div>\n    </div>\n  </div>\n\n  <!-- Form Overlay (Add/Edit) -->\n  <div class=\"overlay\" id=\"form-overlay\">\n    <div class=\"overlay-content\">\n      <h3 id=\"form-title\">Add New Book</h3>\n      <div class=\"form-body\">\n        <div class=\"input-field\">\n          <label>Title</label>\n          <input type=\"text\" id=\"book-title-input\" placeholder=\"e.g. Atomic Habits\">\n        </div>\n        <div class=\"input-field\">\n          <label>Author</label>\n          <input type=\"text\" id=\"book-author-input\" placeholder=\"e.g. James Clear\">\n        </div>\n        <div class=\"input-row\">\n          <div class=\"input-field\">\n            <label>Total Pages</label>\n            <input type=\"number\" id=\"book-total-input\" value=\"300\">\n          </div>\n          <div class=\"input-field\">\n            <label>Emoji</label>\n            <input type=\"text\" id=\"book-emoji-input\" placeholder=\"üìñ\">\n          </div>\n        </div>\n        <div class=\"cover-search-box\">\n           <button class=\"btn-secondary\" id=\"btn-search-books\">üîç Search Online (FR/EN)</button>\n           <div id=\"cover-preview-container\" class=\"cover-preview\" style=\"display:none\">\n              <img id=\"cover-preview-img\" src=\"\" alt=\"Cover Preview\">\n              <button class=\"btn-remove-cover\" id=\"btn-remove-cover\">√ó</button>\n           </div>\n        </div>\n      </div>\n      <div class=\"overlay-actions\">\n        <button class=\"btn-cancel\" id=\"btn-close-form\">Cancel</button>\n        <button class=\"btn-save-progress\" id=\"btn-confirm-form\">Save</button>\n      </div>\n    </div>\n  </div>\n\n  <!-- Search Results Overlay -->\n  <div class=\"overlay\" id=\"search-overlay\">\n    <div class=\"overlay-content search-results-content\">\n      <div class=\"overlay-header\">\n        <h3>Search Results</h3>\n        <button class=\"btn-close\" id=\"btn-close-search\">‚úï</button>\n      </div>\n      <div id=\"search-results-list\" class=\"search-results-list\">\n        <!-- Results here -->\n      </div>\n    </div>\n  </div>\n</div>",
  "css": ":host { display: block; font-family: var(--font-interface); }\n* { box-sizing: border-box; }\n\n.widget-card {\n    background: var(--background-secondary);\n    border: 1px solid var(--background-modifier-border);\n    border-radius: 24px;\n    padding: 1.25rem;\n    box-shadow: var(--shadow-s);\n    position: relative;\n    overflow: hidden;\n    min-height: 400px;\n}\n\n.widget-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n}\n\n.header-left {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.widget-icon { font-size: 1.2rem; }\n.widget-title {\n    margin: 0;\n    font-size: 0.85rem;\n    font-weight: 800;\n    color: var(--text-normal);\n    text-transform: uppercase;\n    letter-spacing: 1px;\n}\n\n.btn-add {\n    background: var(--interactive-accent);\n    color: white;\n    border: none;\n    width: 28px;\n    height: 28px;\n    border-radius: 8px;\n    font-weight: 800;\n    cursor: pointer;\n    transition: all 0.2s;\n}\n.btn-add:hover { transform: scale(1.1); }\n\n.book-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));\n    gap: 15px;\n    margin-bottom: 1rem;\n    max-height: 450px;\n    overflow-y: auto;\n    padding: 10px 5px;\n}\n\n.book-item {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    cursor: pointer;\n    transition: all 0.2s;\n    position: relative;\n}\n\n.book-card-visual {\n    width: 100%;\n    aspect-ratio: 2/3;\n    background: var(--background-primary);\n    border-radius: 12px;\n    overflow: hidden;\n    border: 1px solid var(--background-modifier-border);\n    box-shadow: var(--shadow-s);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n}\n\n.book-item:hover .book-card-visual {\n    transform: translateY(-4px);\n    border-color: var(--interactive-accent);\n    box-shadow: var(--shadow-m);\n}\n\n.card-cover-img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n}\n\n.card-emoji {\n    font-size: 2.5rem;\n}\n\n.card-progress-overlay {\n    position: absolute;\n    bottom: 0; left: 0; width: 100%;\n    height: 4px;\n    background: rgba(255,255,255,0.2);\n}\n\n.card-progress-fill {\n    height: 100%;\n    background: var(--interactive-accent);\n    transition: width 0.3s;\n}\n\n.card-info {\n    text-align: center;\n}\n\n.book-title {\n    display: block;\n    font-weight: 700;\n    font-size: 0.75rem;\n    color: var(--text-normal);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    margin-bottom: 2px;\n}\n\n.book-author {\n    display: block;\n    font-size: 0.6rem;\n    color: var(--text-muted);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.stats-row {\n    display: flex;\n    justify-content: space-around;\n    border-top: 1px solid var(--background-modifier-border);\n    padding-top: 0.75rem;\n}\n\n.stat-item { text-align: center; }\n.stat-val { display: block; font-size: 1.1rem; font-weight: 800; color: var(--text-normal); }\n.stat-lbl { font-size: 0.6rem; font-weight: 700; text-transform: uppercase; color: var(--text-faint); }\n\n/* Overlays */\n.overlay {\n    position: absolute;\n    top: 0; left: 0; width: 100%; height: 100%;\n    background: rgba(0,0,0,0.7);\n    backdrop-filter: blur(8px);\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 100;\n    padding: 0.5rem;\n}\n.overlay.show { display: flex; }\n\n.overlay-content {\n    background: var(--background-primary);\n    padding: 1rem;\n    border-radius: 20px;\n    width: 100%;\n    max-width: 280px;\n    max-height: 98%;\n    overflow-y: auto;\n    box-shadow: 0 15px 40px rgba(0,0,0,0.4);\n    display: flex;\n    flex-direction: column;\n}\n\n.overlay-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 0.75rem;\n}\n.overlay-header h3 {\n    margin: 0;\n    font-size: 0.9rem;\n    color: var(--text-accent);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    max-width: 180px;\n}\n\n.detail-main-info {\n    display: flex;\n    gap: 15px;\n    align-items: center;\n    margin-bottom: 1rem;\n}\n\n.detail-cover {\n    width: 80px;\n    aspect-ratio: 2/3;\n    background: var(--background-secondary);\n    border-radius: 8px;\n    overflow: hidden;\n    border: 1px solid var(--background-modifier-border);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.detail-cover img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n}\n\n.detail-cover span {\n    font-size: 2rem;\n}\n\n.circular-chart {\n    max-width: 70px;\n}\n.circle-bg { fill: none; stroke: var(--background-modifier-border); stroke-width: 2.8; }\n.circle { fill: none; stroke: var(--interactive-accent); stroke-width: 2.8; stroke-linecap: round; transition: stroke-dasharray 0.3s; }\n.percentage { fill: var(--text-normal); font-size: 0.5rem; font-weight: 800; text-anchor: middle; }\n\n.progress-controls {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    margin-bottom: 1rem;\n}\n\n.slider-container {\n    margin-bottom: 8px;\n}\n\n.range-slider {\n    width: 100%;\n    height: 6px;\n    background: var(--background-modifier-border);\n    border-radius: 10px;\n    appearance: none;\n    outline: none;\n}\n\n.range-slider::-webkit-slider-thumb {\n    appearance: none;\n    width: 16px;\n    height: 16px;\n    background: var(--interactive-accent);\n    border-radius: 50%;\n    cursor: pointer;\n    border: 2px solid var(--background-primary);\n    box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n}\n\n.number-input-row {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n}\n\n.total-pages-label {\n    font-size: 0.75rem;\n    font-weight: 700;\n    color: var(--text-faint);\n}\n\n.number-input {\n    display: flex;\n    align-items: center;\n    background: var(--background-secondary);\n    border-radius: 8px;\n    padding: 2px;\n    border: 1px solid var(--background-modifier-border);\n}\n.number-input input {\n    width: 45px;\n    background: transparent;\n    border: none;\n    color: var(--text-normal);\n    text-align: center;\n    font-weight: 700;\n    outline: none;\n    font-size: 0.85rem;\n}\n.step-btn {\n    background: var(--background-modifier-hover);\n    border: none;\n    color: var(--text-normal);\n    width: 22px;\n    height: 22px;\n    border-radius: 6px;\n    cursor: pointer;\n    font-weight: 800;\n}\n\n.input-row {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 8px;\n}\n\n.input-field input {\n    width: 100%;\n    background: var(--background-secondary);\n    border: 1px solid var(--background-modifier-border);\n    color: var(--text-normal);\n    padding: 6px 10px;\n    border-radius: 8px;\n    outline: none;\n    font-size: 0.8rem;\n}\n\n.cover-search-box {\n    margin-top: 8px;\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.btn-secondary {\n    background: var(--background-modifier-border);\n    color: var(--text-normal);\n    border: none;\n    padding: 8px;\n    border-radius: 8px;\n    font-size: 0.75rem;\n    font-weight: 700;\n    cursor: pointer;\n    transition: all 0.2s;\n}\n.btn-secondary:hover { background: var(--background-modifier-hover); }\n\n.cover-preview {\n    position: relative;\n    width: 60px;\n    height: 90px;\n    margin: 0 auto;\n    border-radius: 6px;\n    overflow: hidden;\n    border: 1px solid var(--background-modifier-border);\n}\n\n.cover-preview img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n}\n\n.btn-remove-cover {\n    position: absolute;\n    top: 2px; right: 2px;\n    background: rgba(0,0,0,0.5);\n    color: white;\n    border: none;\n    width: 18px; height: 18px;\n    border-radius: 50%;\n    cursor: pointer;\n    font-size: 10px;\n    display: flex; align-items: center; justify-content: center;\n}\n\n.search-results-list {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    margin-top: 10px;\n}\n\n.search-result-item {\n    display: flex;\n    gap: 12px;\n    padding: 8px;\n    background: var(--background-secondary);\n    border-radius: 12px;\n    cursor: pointer;\n    transition: all 0.2s;\n    border: 1px solid transparent;\n}\n\n.search-result-item:hover {\n    background: var(--background-modifier-hover);\n    border-color: var(--interactive-accent);\n}\n\n.search-result-cover {\n    width: 40px;\n    height: 60px;\n    background: var(--background-primary);\n    border-radius: 4px;\n    object-fit: cover;\n}\n\n.search-result-info {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    min-width: 0;\n}\n\n.search-result-title {\n    font-weight: 700;\n    font-size: 0.8rem;\n    color: var(--text-normal);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.search-result-author {\n    font-size: 0.65rem;\n    color: var(--text-muted);\n}\n\n.search-result-meta {\n    font-size: 0.6rem;\n    color: var(--text-faint);\n    margin-top: 2px;\n}\n\n.overlay-actions {\n    display: flex;\n    gap: 8px;\n    margin-top: auto;\n}\n\n.btn-save-progress, .btn-delete-book, .btn-cancel {\n    flex: 1;\n    padding: 8px;\n    border-radius: 10px;\n    font-weight: 700;\n    cursor: pointer;\n    border: none;\n    font-size: 0.75rem;\n}\n\n.btn-save-progress { background: var(--interactive-accent); color: white; }\n.btn-delete-book { background: var(--background-modifier-error); color: white; }\n.btn-cancel { background: var(--background-modifier-border); color: var(--text-normal); }\n\n/* Custom Scrollbar */\n.book-grid::-webkit-scrollbar, .overlay-content::-webkit-scrollbar, .search-results-list::-webkit-scrollbar {\n    width: 4px;\n}\n.book-grid::-webkit-scrollbar-thumb, .overlay-content::-webkit-scrollbar-thumb, .search-results-list::-webkit-scrollbar-thumb {\n    background: var(--background-modifier-border);\n    border-radius: 10px;\n}",
  "js": "const { root, saveState, getState } = api;\n\nlet books = [\n    { title: 'Atomic Habits', author: 'James Clear', pages: 320, current: 150, emoji: 'üîã', cover: null },\n    { title: 'Deep Work', author: 'Cal Newport', pages: 296, current: 296, emoji: 'üß†', cover: null }\n];\n\nlet selectedIdx = null;\nlet isEditing = false;\nlet tempCover = null;\n\nfunction render() {\n    const grid = root.getElementById('book-grid');\n    grid.innerHTML = '';\n    \n    let readCount = 0;\n    let totalPagesRead = 0;\n\n    books.forEach((book, idx) => {\n        const isRead = book.current >= book.pages;\n        if (isRead) readCount++;\n        totalPagesRead += book.current;\n\n        const percent = Math.min(100, Math.round((book.current / book.pages) * 100));\n        \n        const card = document.createElement('div');\n        card.className = 'book-item';\n        \n        const visualContent = book.cover \n            ? `<img src=\"${book.cover}\" class=\"card-cover-img\" alt=\"Cover\">` \n            : `<span class=\"card-emoji\">${book.emoji || 'üìñ'}</span>`;\n\n        card.innerHTML = `\n            <div class=\"book-card-visual\">\n                ${visualContent}\n                <div class=\"card-progress-overlay\">\n                    <div class=\"card-progress-fill\" style=\"width: ${percent}%\"></div>\n                </div>\n            </div>\n            <div class=\"card-info\">\n                <span class=\"book-title\">${book.title}</span>\n                <span class=\"book-author\">${book.author}</span>\n            </div>\n        `;\n        \n        card.onclick = () => openDetail(idx);\n        grid.appendChild(card);\n    });\n\n    root.getElementById('books-read').innerText = readCount;\n    root.getElementById('pages-total').innerText = totalPagesRead;\n}\n\nfunction updateDetailVisuals(current, total) {\n    const percent = Math.min(100, Math.round((current / total) * 100));\n    root.getElementById('detail-percent').textContent = percent + '%';\n    root.getElementById('detail-circle').setAttribute('stroke-dasharray', `${percent}, 100`);\n    \n    const slider = root.getElementById('input-slider');\n    slider.max = total;\n    slider.value = current;\n    \n    root.getElementById('input-current-page').value = current;\n}\n\nfunction openDetail(idx) {\n    selectedIdx = idx;\n    const book = books[idx];\n\n    root.getElementById('detail-title').innerText = book.title;\n    root.getElementById('detail-total-pages').innerText = `/ ${book.pages}p`;\n    \n    const coverContainer = root.getElementById('detail-cover-container');\n    if (book.cover) {\n        coverContainer.innerHTML = `<img src=\"${book.cover}\" alt=\"Cover\">`;\n    } else {\n        coverContainer.innerHTML = `<span>${book.emoji || 'üìñ'}</span>`;\n    }\n\n    updateDetailVisuals(book.current, book.pages);\n    root.getElementById('detail-overlay').classList.add('show');\n}\n\nfunction closeDetail() {\n    root.getElementById('detail-overlay').classList.remove('show');\n    selectedIdx = null;\n}\n\nfunction saveProgress() {\n    if (selectedIdx === null) return;\n    const newVal = parseInt(root.getElementById('input-current-page').value);\n    books[selectedIdx].current = Math.max(0, Math.min(books[selectedIdx].pages, newVal));\n    \n    closeDetail();\n    render();\n    saveState(books);\n}\n\nfunction deleteBook() {\n    if (selectedIdx === null) return;\n    if (confirm(`Delete \"${books[selectedIdx].title}\"?`)) {\n        books.splice(selectedIdx, 1);\n        closeDetail();\n        render();\n        saveState(books);\n    }\n}\n\nasync function searchBooks() {\n    const title = root.getElementById('book-title-input').value;\n    const author = root.getElementById('book-author-input').value;\n    if (!title) return alert('Please enter a title first.');\n\n    const btn = root.getElementById('btn-search-books');\n    btn.innerText = '‚åõ Searching...';\n    btn.disabled = true;\n\n    try {\n        const query = encodeURIComponent(`${title} ${author}`);\n        // Open Library search with multiple languages support\n        const response = await fetch(`https://openlibrary.org/search.json?q=${query}&limit=10`);\n        const data = await response.json();\n\n        if (data.docs && data.docs.length > 0) {\n            displaySearchResults(data.docs);\n        } else {\n            alert('No books found.');\n        }\n    } catch (e) {\n        console.error(e);\n        alert('Error searching books.');\n    } finally {\n        btn.innerText = 'üîç Search Online (FR/EN)';\n        btn.disabled = false;\n    }\n}\n\nfunction displaySearchResults(docs) {\n    const list = root.getElementById('search-results-list');\n    list.innerHTML = '';\n    \n    docs.forEach(doc => {\n        const pages = doc.number_of_pages_median || doc.number_of_pages || 0;\n        const author = doc.author_name ? doc.author_name[0] : 'Unknown Author';\n        const lang = doc.language ? doc.language.join(', ') : '';\n        const coverUrl = doc.cover_i ? `https://covers.openlibrary.org/b/id/${doc.cover_i}-S.jpg` : null;\n\n        const item = document.createElement('div');\n        item.className = 'search-result-item';\n        item.innerHTML = `\n            ${coverUrl ? `<img src=\"${coverUrl}\" class=\"search-result-cover\">` : '<div class=\"search-result-cover\" style=\"display:flex;align-items:center;justify-content:center;font-size:20px\">üìñ</div>'}\n            <div class=\"search-result-info\">\n                <div class=\"search-result-title\">${doc.title}</div>\n                <div class=\"search-result-author\">${author}</div>\n                <div class=\"search-result-meta\">${pages > 0 ? pages + 'p' : ''} ${lang ? '‚Ä¢ ' + lang.toUpperCase() : ''}</div>\n            </div>\n        `;\n        \n        item.onclick = () => selectBook(doc);\n        list.appendChild(item);\n    });\n\n    root.getElementById('search-overlay').classList.add('show');\n}\n\nfunction selectBook(doc) {\n    root.getElementById('book-title-input').value = doc.title;\n    root.getElementById('book-author-input').value = doc.author_name ? doc.author_name[0] : '';\n    \n    let pages = doc.number_of_pages_median || doc.number_of_pages || 300;\n    if (Array.isArray(pages)) pages = pages[0];\n    root.getElementById('book-total-input').value = pages;\n\n    if (doc.cover_i) {\n        tempCover = `https://covers.openlibrary.org/b/id/${doc.cover_i}-M.jpg`;\n        showCoverPreview(tempCover);\n    } else if (doc.isbn && doc.isbn.length > 0) {\n        tempCover = `https://covers.openlibrary.org/b/isbn/${doc.isbn[0]}-M.jpg`;\n        showCoverPreview(tempCover);\n    } else {\n        removeCover();\n    }\n\n    root.getElementById('search-overlay').classList.remove('show');\n}\n\nfunction showCoverPreview(url) {\n    const container = root.getElementById('cover-preview-container');\n    const img = root.getElementById('cover-preview-img');\n    img.src = url;\n    container.style.display = 'block';\n}\n\nfunction removeCover() {\n    tempCover = null;\n    root.getElementById('cover-preview-container').style.display = 'none';\n}\n\nfunction openForm(idx = null) {\n    isEditing = idx !== null;\n    selectedIdx = idx;\n    \n    const title = root.getElementById('form-title');\n    const inputTitle = root.getElementById('book-title-input');\n    const inputAuthor = root.getElementById('book-author-input');\n    const inputTotal = root.getElementById('book-total-input');\n    const inputEmoji = root.getElementById('book-emoji-input');\n\n    if (isEditing) {\n        const book = books[idx];\n        title.innerText = \"Edit Book\";\n        inputTitle.value = book.title;\n        inputAuthor.value = book.author;\n        inputTotal.value = book.pages;\n        inputEmoji.value = book.emoji || 'üìñ';\n        tempCover = book.cover;\n        if (tempCover) showCoverPreview(tempCover);\n        else removeCover();\n        root.getElementById('detail-overlay').classList.remove('show');\n    } else {\n        title.innerText = \"Add New Book\";\n        inputTitle.value = '';\n        inputAuthor.value = '';\n        inputTotal.value = 300;\n        inputEmoji.value = 'üìñ';\n        removeCover();\n    }\n\n    root.getElementById('form-overlay').classList.add('show');\n}\n\nfunction closeForm() {\n    root.getElementById('form-overlay').classList.remove('show');\n    if (isEditing && selectedIdx !== null) {\n        openDetail(selectedIdx);\n    }\n}\n\nfunction confirmForm() {\n    const title = root.getElementById('book-title-input').value || 'New Book';\n    const author = root.getElementById('book-author-input').value || 'Unknown';\n    const total = parseInt(root.getElementById('book-total-input').value) || 300;\n    const emoji = root.getElementById('book-emoji-input').value || 'üìñ';\n\n    if (isEditing && selectedIdx !== null) {\n        books[selectedIdx].title = title;\n        books[selectedIdx].author = author;\n        books[selectedIdx].pages = total;\n        books[selectedIdx].emoji = emoji;\n        books[selectedIdx].cover = tempCover;\n        books[selectedIdx].current = Math.min(books[selectedIdx].current, total);\n    } else {\n        books.push({\n            title: title,\n            author: author,\n            pages: total,\n            current: 0,\n            emoji: emoji,\n            cover: tempCover\n        });\n    }\n\n    root.getElementById('form-overlay').classList.remove('show');\n    render();\n    saveState(books);\n}\n\nasync function init() {\n    const saved = await getState();\n    if (saved) books = saved;\n\n    root.getElementById('btn-add').onclick = () => openForm();\n    root.getElementById('btn-close-form').onclick = closeForm;\n    root.getElementById('btn-confirm-form').onclick = confirmForm;\n    root.getElementById('btn-search-books').onclick = searchBooks;\n    root.getElementById('btn-close-search').onclick = () => root.getElementById('search-overlay').classList.remove('show');\n    root.getElementById('btn-remove-cover').onclick = removeCover;\n    \n    root.getElementById('btn-close-detail').onclick = closeDetail;\n    root.getElementById('btn-save-progress').onclick = saveProgress;\n    root.getElementById('btn-delete-book').onclick = deleteBook;\n    root.getElementById('btn-edit-book').onclick = () => openForm(selectedIdx);\n\n    const pageInput = root.getElementById('input-current-page');\n    const slider = root.getElementById('input-slider');\n\n    slider.oninput = (e) => {\n        const val = parseInt(e.target.value);\n        pageInput.value = val;\n        updateDetailVisuals(val, books[selectedIdx].pages);\n    };\n\n    pageInput.oninput = (e) => {\n        const val = Math.max(0, Math.min(books[selectedIdx].pages, parseInt(e.target.value) || 0));\n        slider.value = val;\n        updateDetailVisuals(val, books[selectedIdx].pages);\n    };\n\n    root.getElementById('btn-step-minus').onclick = () => {\n        const val = Math.max(0, parseInt(pageInput.value) - 1);\n        pageInput.value = val;\n        slider.value = val;\n        updateDetailVisuals(val, books[selectedIdx].pages);\n    };\n    root.getElementById('btn-step-plus').onclick = () => {\n        const val = Math.min(books[selectedIdx].pages, parseInt(pageInput.value) + 1);\n        pageInput.value = val;\n        slider.value = val;\n        updateDetailVisuals(val, books[selectedIdx].pages);\n    };\n\n    render();\n}\n\ninit();",
  "tags": [
    "reading",
    "tracker",
    "organization",
    "premium",
    "books",
    "slider",
    "covers",
    "api",
    "search"
  ]
}
{
  "id": "hydro-pulse",
  "name": "Hydro Pulse",
  "description": "Track your daily water intake and stay hydrated.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"widget-card\">\n  <div class=\"widget-header\">\n    <div class=\"header-left\">\n      <span class=\"icon\">üíß</span>\n      <h4 class=\"widget-title\">Hydro Pulse</h4>\n    </div>\n    <button id=\"btn-settings\" class=\"icon-btn\" title=\"Edit Goal\">‚öôÔ∏è</button>\n  </div>\n\n  \n  <div id=\"settings-panel\" class=\"settings-overlay hidden\">\n    <div class=\"settings-content\">\n      <h5>Daily Goal (ml)</h5>\n      <input type=\"number\" id=\"inp-goal\" step=\"100\">\n      <button id=\"btn-save-goal\" class=\"btn-primary\">Save Goal</button>\n    </div>\n  </div>\n\n  \n  <div class=\"hydro-visual\">\n    <div class=\"circle-container\">\n      \n      <div class=\"wave-wrapper\" id=\"wave-wrapper\">\n        <div class=\"wave wave-one\"></div>\n        <div class=\"wave wave-two\"></div>\n      </div>\n      <div class=\"info-overlay\">\n        <span id=\"percent-display\" class=\"big-percent\">0%</span>\n        <span id=\"amount-display\" class=\"small-amount\">0 / 2500 ml</span>\n      </div>\n    </div>\n  </div>\n\n  \n  <div class=\"controls-grid\">\n    <button class=\"add-btn\" id=\"btn-250\">+250ml</button>\n    <button class=\"add-btn\" id=\"btn-500\">+500ml</button>\n    <button class=\"action-btn\" id=\"btn-undo\" title=\"Undo last\">‚Ü©Ô∏è</button>\n    <button class=\"action-btn\" id=\"btn-reset\" title=\"Reset day\">üóëÔ∏è</button>\n  </div>\n</div>",
  "css": ":host { display: block; margin: 1rem 0; font-family: var(--font-interface); } * { box-sizing: border-box; } .widget-card { background: var(--background-secondary); border: 1px solid var(--background-modifier-border); border-radius: 20px; padding: 1.5rem; box-shadow: var(--shadow-s); max-width: 350px; margin: 0 auto; position: relative; overflow: hidden; } .widget-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; } .header-left { display: flex; align-items: center; gap: 8px; } .widget-title { margin: 0; font-size: 1rem; font-weight: 800; color: var(--text-normal); text-transform: uppercase; letter-spacing: 1px; } .icon-btn { background: transparent; border: 1px solid var(--background-modifier-border); border-radius: 8px; cursor: pointer; color: var(--text-muted); padding: 4px 8px; transition: all 0.2s; } .icon-btn:hover { background: var(--background-modifier-hover); color: var(--text-normal); } .hydro-visual { display: flex; justify-content: center; margin-bottom: 2rem; } .circle-container { width: 160px; height: 160px; border-radius: 50%; border: 4px solid var(--background-modifier-border); position: relative; overflow: hidden; background: var(--background-primary); box-shadow: inset 0 0 20px rgba(0,0,0,0.05); } .wave-wrapper { position: absolute; width: 200%; height: 200%; top: 100%; left: -50%; /* No transition by default to fix reload glitch */ } .wave-wrapper.animate-height { transition: top 0.8s cubic-bezier(0.4, 0, 0.2, 1); } .wave { position: absolute; width: 100%; height: 100%; border-radius: 40%; animation: rotate 10s infinite linear; } .wave-one { background: rgba(14, 165, 233, 0.4); z-index: 1; animation-duration: 8s; } .wave-two { background: rgba(14, 165, 233, 0.8); z-index: 2; margin-top: 5px; animation-duration: 12s; } @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } } .info-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; text-shadow: 0 2px 10px rgba(0,0,0,0.1); } .big-percent { font-size: 2rem; font-weight: 900; color: var(--text-normal); mix-blend-mode: difference; } .small-amount { font-size: 0.8rem; font-weight: 600; color: var(--text-muted); margin-top: 4px; } .controls-grid { display: grid; grid-template-columns: 2fr 2fr 1fr 1fr; gap: 8px; } .add-btn { background: #0ea5e9; color: white; border: none; padding: 12px; border-radius: 12px; font-weight: 700; cursor: pointer; transition: transform 0.1s, filter 0.2s; } .add-btn:hover { filter: brightness(1.1); transform: translateY(-2px); } .add-btn:active { transform: translateY(0); } .action-btn { background: var(--background-primary); border: 1px solid var(--background-modifier-border); color: var(--text-muted); border-radius: 12px; cursor: pointer; font-size: 1rem; transition: all 0.2s; } .action-btn:hover { background: var(--background-modifier-error); color: white; border-color: transparent; } .settings-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.85); z-index: 20; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.2s; } .settings-overlay:not(.hidden) { opacity: 1; pointer-events: all; } .settings-content { background: var(--background-primary); padding: 1.5rem; border-radius: 16px; width: 85%; text-align: center; } .settings-content h5 { margin: 0 0 1rem 0; color: var(--text-normal); } .settings-content input { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid var(--background-modifier-border); background: var(--background-secondary); color: var(--text-normal); text-align: center; font-size: 1.2rem; margin-bottom: 1rem; } .btn-primary { width: 100%; background: var(--interactive-accent); color: white; border: none; padding: 10px; border-radius: 8px; font-weight: bold; cursor: pointer; }",
  "js": "var root = api.root;\nvar saveState = api.saveState;\nvar getState = api.getState;\n\nvar state = {\n  current: 0,\n  goal: 2500,\n  history: []\n};\n\nfunction render() {\n  var pct = Math.min((state.current / state.goal) * 100, 100);\n  var topVal = 100 - (pct * 1.1);\n  \n  var wave = root.getElementById('wave-wrapper');\n  \n  // Just set the position. \n  // The animation depends on whether the class 'animate-height' is present.\n  wave.style.top = topVal + '%';\n  \n  root.getElementById('percent-display').innerText = Math.round(pct) + '%';\n  root.getElementById('amount-display').innerText = state.current + ' / ' + state.goal + ' ml';\n  \n  var wave2 = root.querySelector('.wave-two');\n  if (pct >= 100) {\n      if(wave2) wave2.style.background = '#10b981';\n  } else {\n      if(wave2) wave2.style.background = 'rgba(14, 165, 233, 0.8)';\n  }\n}\n\nfunction addWater(amount) {\n  state.history.push(state.current);\n  state.current += amount;\n  render();\n  saveState(state);\n}\n\nfunction undo() {\n  if (state.history.length > 0) {\n      state.current = state.history.pop();\n      render();\n      saveState(state);\n  }\n}\n\nfunction reset() {\n  if(confirm('Reset water tracker?')) {\n      state.history = [];\n      state.current = 0;\n      render();\n      saveState(state);\n  }\n}\n\nfunction toggleSettings(show) {\n  var el = root.getElementById('settings-panel');\n  if(show) {\n      el.classList.remove('hidden');\n      root.getElementById('inp-goal').value = state.goal;\n  } else {\n      el.classList.add('hidden');\n  }\n}\n\nfunction saveGoal() {\n  var val = parseInt(root.getElementById('inp-goal').value);\n  if(val && val > 0) {\n      state.goal = val;\n      toggleSettings(false);\n      render();\n      saveState(state);\n  }\n}\n\nasync function init() {\n  var saved = await getState();\n  if (saved) {\n      if(typeof saved === 'number') state.current = saved;\n      else Object.assign(state, saved);\n  }\n  \n  // 1. Initial Render (Instant, no animation class yet)\n  render();\n  \n  // 2. Force Reflow (The trick to fix the reload glitch)\n  var wave = root.getElementById('wave-wrapper');\n  void wave.offsetWidth; \n  \n  // 3. Enable Animation for future clicks\n  wave.classList.add('animate-height');\n  \n  // Listeners\n  root.getElementById('btn-250').onclick = function() { addWater(250); };\n  root.getElementById('btn-500').onclick = function() { addWater(500); };\n  root.getElementById('btn-undo').onclick = undo;\n  root.getElementById('btn-reset').onclick = reset;\n  \n  root.getElementById('btn-settings').onclick = function() { toggleSettings(true); };\n  root.getElementById('btn-save-goal').onclick = saveGoal;\n}\n\ninit();",
  "tags": [
    "health",
    "hydration",
    "tracker",
    "animated"
  ]
}
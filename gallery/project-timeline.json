{
  "id": "project-timeline",
  "name": "Project Timeline",
  "description": "Visualize your project milestones and deadlines.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"timeline-widget\">\n  <div class=\"widget-header\">\n    <div class=\"header-left\">\n      <h4 class=\"widget-title\">üöÄ Project Timeline</h4>\n      <div class=\"progress-mini\"><span id=\"progress-text\">0%</span> Complete</div>\n    </div>\n    <div class=\"header-actions\">\n      <div class=\"zoom-control\" id=\"zoom-control\" style=\"display:none\">\n        <span class=\"zoom-icon\">üîç</span>\n        <input type=\"range\" id=\"input-zoom\" min=\"10\" max=\"120\" value=\"40\">\n      </div>\n      <button class=\"btn-icon secondary\" id=\"btn-view-toggle\" title=\"Switch View\">üìä</button>\n      <button class=\"btn-icon\" id=\"btn-add-toggle\" title=\"Add Milestone\">+</button>\n    </div>\n  </div>\n\n  <div class=\"progress-bar-container\">\n    <div id=\"main-progress-bar\" class=\"progress-bar-fill\"></div>\n  </div>\n\n  <div class=\"milestone-form\" id=\"milestone-form\">\n    <input type=\"text\" id=\"input-title\" placeholder=\"Milestone Title...\">\n    <div class=\"date-row\">\n      <div class=\"date-input\">\n        <label>Start Date</label>\n        <input type=\"date\" id=\"input-start\">\n      </div>\n      <div class=\"date-input\">\n        <label>End Date</label>\n        <input type=\"date\" id=\"input-end\">\n      </div>\n    </div>\n    <div class=\"form-actions\">\n      <button class=\"btn-cancel\" id=\"btn-cancel\">Cancel</button>\n      <button class=\"btn-save\" id=\"btn-save\">Add</button>\n    </div>\n  </div>\n\n  <div id=\"view-container\">\n    <div class=\"timeline-container\" id=\"timeline-list\"></div>\n    <div class=\"gantt-container\" id=\"gantt-view\" style=\"display:none\">\n      <div class=\"gantt-header\" id=\"gantt-header\"></div>\n      <div class=\"gantt-body\" id=\"gantt-body\"></div>\n    </div>\n  </div>\n\n  <div class=\"timeline-footer\">\n    <div class=\"stat-item\">\n      <span id=\"done-count\">0</span>\n      <label>Completed</label>\n    </div>\n    <div class=\"stat-item\">\n      <span id=\"total-count\">0</span>\n      <label>Total</label>\n    </div>\n    <button class=\"btn-clear\" id=\"btn-clear-all\">Clear All</button>\n  </div>\n</div>",
  "css": ":host { display: block; font-family: var(--font-interface); }\n* { box-sizing: border-box; }\n\n.timeline-widget {\n    background: var(--background-secondary);\n    border: 1px solid var(--background-modifier-border);\n    border-radius: 24px;\n    padding: 1.5rem;\n    color: var(--text-normal);\n    box-shadow: var(--shadow-s);\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n}\n\n.widget-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.header-actions { display: flex; gap: 12px; align-items: center; }\n\n.widget-title {\n    margin: 0;\n    font-size: 0.8rem;\n    font-weight: 700;\n    text-transform: uppercase;\n    letter-spacing: 0.1em;\n    color: var(--text-muted);\n}\n\n.progress-mini {\n    font-size: 0.65rem;\n    font-weight: 600;\n    color: var(--text-faint);\n    margin-top: 2px;\n}\n\n.zoom-control {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    background: var(--background-primary);\n    padding: 4px 10px;\n    border-radius: 8px;\n    border: 1px solid var(--background-modifier-border);\n}\n\n.zoom-icon { font-size: 0.7rem; opacity: 0.6; }\n\n#input-zoom {\n    width: 60px;\n    height: 4px;\n    accent-color: var(--interactive-accent);\n    cursor: pointer;\n}\n\n.btn-icon {\n    background: var(--interactive-accent);\n    color: var(--text-on-accent);\n    border: none;\n    width: 28px;\n    height: 28px;\n    border-radius: 8px;\n    font-size: 1.1rem;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s;\n}\n.btn-icon.secondary { background: var(--background-modifier-border); color: var(--text-muted); }\n.btn-icon:hover { transform: scale(1.1); }\n\n.progress-bar-container {\n    height: 6px;\n    background: var(--background-primary);\n    border-radius: 3px;\n    overflow: hidden;\n    border: 1px solid var(--background-modifier-border);\n}\n\n.progress-bar-fill {\n    height: 100%;\n    width: 0%;\n    background: var(--interactive-accent);\n    transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);\n    box-shadow: 0 0 10px rgba(var(--interactive-accent-rgb), 0.3);\n}\n\n/* Form Styling */\n.milestone-form {\n    display: none;\n    flex-direction: column;\n    gap: 12px;\n    background: var(--background-primary);\n    padding: 1rem;\n    border-radius: 16px;\n    border: 1px solid var(--background-modifier-border);\n    animation: slideDown 0.3s ease-out;\n}\n.milestone-form.show { display: flex; }\n\n.date-row {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 10px;\n}\n\n.date-input label {\n    display: block;\n    font-size: 0.6rem;\n    font-weight: 700;\n    color: var(--text-faint);\n    text-transform: uppercase;\n    margin-bottom: 4px;\n}\n\n.milestone-form input {\n    background: var(--background-secondary);\n    border: 1px solid var(--background-modifier-border);\n    color: var(--text-normal);\n    padding: 8px 12px;\n    border-radius: 8px;\n    font-size: 0.85rem;\n    outline: none;\n    width: 100%;\n}\n\n.form-actions {\n    display: flex;\n    gap: 8px;\n    justify-content: flex-end;\n}\n\n.btn-save, .btn-cancel {\n    padding: 6px 16px;\n    border-radius: 8px;\n    font-size: 0.75rem;\n    font-weight: 700;\n    cursor: pointer;\n    border: none;\n}\n.btn-save { background: var(--interactive-accent); color: var(--text-on-accent); }\n.btn-cancel { background: transparent; color: var(--text-muted); }\n\n/* Timeline List */\n.timeline-container {\n    position: relative;\n    padding-left: 24px;\n    margin-top: 0.5rem;\n    max-height: 400px;\n    overflow-y: auto;\n}\n\n.timeline-container::before {\n    content: '';\n    position: absolute;\n    left: 7px;\n    top: 0;\n    bottom: 0;\n    width: 2px;\n    background: var(--background-modifier-border);\n}\n\n.milestone-item {\n    position: relative;\n    margin-bottom: 20px;\n    display: flex;\n    align-items: flex-start;\n    gap: 12px;\n}\n\n.milestone-dot {\n    position: absolute;\n    left: -24px;\n    top: 4px;\n    width: 16px;\n    height: 16px;\n    border-radius: 50%;\n    background: var(--background-primary);\n    border: 3px solid var(--background-modifier-border);\n    z-index: 1;\n    cursor: pointer;\n    transition: all 0.2s;\n}\n\n.milestone-item.done .milestone-dot {\n    background: var(--interactive-accent);\n    border-color: var(--interactive-accent);\n}\n\n.milestone-content {\n    flex: 1;\n    background: rgba(255,255,255,0.03);\n    padding: 10px 14px;\n    border-radius: 12px;\n    border: 1px solid transparent;\n    cursor: pointer;\n}\n\n.milestone-title {\n    display: block;\n    font-weight: 600;\n    font-size: 0.9rem;\n}\n.milestone-item.done .milestone-title { text-decoration: line-through; color: var(--text-faint); }\n\n.milestone-date {\n    font-size: 0.7rem;\n    font-weight: 600;\n    color: var(--text-muted);\n}\n\n.milestone-actions {\n    display: flex;\n    gap: 4px;\n    opacity: 0;\n}\n.milestone-item:hover .milestone-actions { opacity: 1; }\n\n.btn-action {\n    background: none;\n    border: none;\n    cursor: pointer;\n    font-size: 0.9rem;\n    color: var(--text-muted);\n}\n\n/* Gantt View */\n.gantt-container {\n    overflow-x: auto;\n    background: var(--background-primary);\n    border-radius: 16px;\n    border: 1px solid var(--background-modifier-border);\n    padding: 1rem;\n    min-height: 200px;\n    scrollbar-width: none; /* Firefox */\n    -ms-overflow-style: none; /* IE/Edge */\n    cursor: grab;\n    user-select: none;\n}\n\n.gantt-container:active { cursor: grabbing; }\n\n.gantt-container::-webkit-scrollbar {\n    display: none; /* Chrome/Safari */\n}\n\n.gantt-header {\n    display: flex;\n    border-bottom: 1px solid var(--background-modifier-border);\n    padding-bottom: 8px;\n    margin-bottom: 12px;\n    position: sticky;\n    top: 0;\n    background: var(--background-primary);\n    z-index: 5;\n    pointer-events: none;\n}\n\n.gantt-tick {\n    flex-shrink: 0;\n    font-size: 0.6rem;\n    font-weight: 800;\n    color: var(--text-faint);\n    text-align: center;\n    border-left: 1px solid rgba(255,255,255,0.05);\n}\n\n.gantt-row {\n    display: flex;\n    align-items: center;\n    height: 32px;\n    margin-bottom: 8px;\n    position: relative;\n}\n\n.gantt-bar {\n    position: absolute;\n    height: 20px;\n    background: var(--background-modifier-border);\n    border-radius: 10px;\n    display: flex;\n    align-items: center;\n    padding: 0 10px;\n    font-size: 0.65rem;\n    font-weight: 700;\n    color: var(--text-normal);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    transition: left 0.3s, width 0.3s, background 0.3s;\n    cursor: pointer;\n}\n\n.gantt-bar.done {\n    background: var(--interactive-accent);\n    color: var(--text-on-accent);\n    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb), 0.3);\n}\n\n/* Footer */\n.timeline-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding-top: 1rem;\n    border-top: 1px solid var(--background-modifier-border);\n}\n\n.stat-item { text-align: left; }\n.stat-item span { display: block; font-size: 1rem; font-weight: 800; }\n.stat-item label { font-size: 0.6rem; font-weight: 700; text-transform: uppercase; color: var(--text-muted); }",
  "js": "const { root, saveState, getState } = api;\n\nlet state = {\n    milestones: [\n        { id: 1, title: 'Project Kickoff', start: '2026-01-10', end: '2026-01-12', done: true },\n        { id: 2, title: 'Design Phase', start: '2026-01-13', end: '2026-01-20', done: false },\n        { id: 3, title: 'Development', start: '2026-01-21', end: '2026-02-15', done: false }\n    ],\n    viewMode: 'timeline',\n    zoom: 40,\n    editingId: null\n};\n\nlet isDragging = false;\nlet startX, scrollLeft;\n\nfunction formatDate(dateStr) {\n    if (!dateStr || dateStr === 'TBD') return 'TBD';\n    const d = new Date(dateStr);\n    return d.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });\n}\n\nfunction render() {\n    const timelineList = root.getElementById('timeline-list');\n    const ganttView = root.getElementById('gantt-view');\n    const zoomControl = root.getElementById('zoom-control');\n    \n    if (state.viewMode === 'timeline') {\n        timelineList.style.display = 'block';\n        ganttView.style.display = 'none';\n        zoomControl.style.display = 'none';\n        renderTimeline();\n    } else {\n        timelineList.style.display = 'none';\n        ganttView.style.display = 'block';\n        zoomControl.style.display = 'flex';\n        renderGantt();\n    }\n\n    // Update Stats\n    const doneCount = state.milestones.filter(m => m.done).length;\n    root.getElementById('done-count').innerText = doneCount;\n    root.getElementById('total-count').innerText = state.milestones.length;\n    \n    const progress = state.milestones.length > 0 ? Math.round((doneCount / state.milestones.length) * 100) : 0;\n    root.getElementById('progress-text').innerText = `${progress}%`;\n    \n    // Fix animation: only update width if it changed to avoid resets\n    const bar = root.getElementById('main-progress-bar');\n    if (bar.style.width !== `${progress}%`) {\n        bar.style.width = `${progress}%`;\n    }\n}\n\nfunction renderTimeline() {\n    const container = root.getElementById('timeline-list');\n    container.innerHTML = '';\n    \n    state.milestones.sort((a,b) => new Date(a.start) - new Date(b.start)).forEach((m) => {\n        const item = document.createElement('div');\n        item.className = `milestone-item ${m.done ? 'done' : ''}`;\n        item.innerHTML = `\n            <div class=\"milestone-dot\"></div>\n            <div class=\"milestone-content\">\n                <span class=\"milestone-title\">${m.title}</span>\n                <span class=\"milestone-date\">${formatDate(m.start)} - ${formatDate(m.end)}</span>\n            </div>\n            <div class=\"milestone-actions\">\n                <button class=\"btn-action edit\">‚úèÔ∏è</button>\n                <button class=\"btn-action del\">üóëÔ∏è</button>\n            </div>\n        `;\n        \n        item.querySelector('.milestone-dot').onclick = () => toggleMilestone(m.id);\n        item.querySelector('.milestone-content').onclick = () => toggleMilestone(m.id);\n        item.querySelector('.edit').onclick = (e) => { e.stopPropagation(); startEdit(m.id); };\n        item.querySelector('.del').onclick = (e) => { e.stopPropagation(); deleteMilestone(m.id); };\n        \n        container.appendChild(item);\n    });\n}\n\nfunction renderGantt() {\n    const header = root.getElementById('gantt-header');\n    const body = root.getElementById('gantt-body');\n    \n    if (state.milestones.length === 0) {\n        header.innerHTML = '';\n        body.innerHTML = '<div style=\"text-align:center; padding: 2rem; color: var(--text-faint);\">No milestones to display</div>';\n        return;\n    }\n\n    const dates = state.milestones.flatMap(m => [new Date(m.start), new Date(m.end)]);\n    const minDate = new Date(Math.min(...dates));\n    const maxDate = new Date(Math.max(...dates));\n    \n    minDate.setDate(minDate.getDate() - 2);\n    maxDate.setDate(maxDate.getDate() + 5);\n\n    const totalDays = Math.ceil((maxDate - minDate) / (1000 * 60 * 60 * 24));\n    const dayWidth = state.zoom || 40;\n\n    header.innerHTML = '';\n    body.innerHTML = '';\n    body.style.width = `${totalDays * dayWidth}px`;\n    header.style.width = `${totalDays * dayWidth}px`;\n\n    for (let i = 0; i < totalDays; i++) {\n        const d = new Date(minDate);\n        d.setDate(d.getDate() + i);\n        const tick = document.createElement('div');\n        tick.className = 'gantt-tick';\n        tick.style.width = `${dayWidth}px`;\n        tick.innerText = d.getDate() === 1 || i === 0 ? d.toLocaleDateString('en-US', {month:'short'}) : d.getDate();\n        header.appendChild(tick);\n    }\n\n    state.milestones.forEach(m => {\n        const start = new Date(m.start);\n        const end = new Date(m.end);\n        const left = Math.ceil((start - minDate) / (1000 * 60 * 60 * 24)) * dayWidth;\n        const width = Math.max(1, Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1) * dayWidth;\n\n        const row = document.createElement('div');\n        row.className = 'gantt-row';\n        row.innerHTML = `<div class=\"gantt-bar ${m.done ? 'done' : ''}\" style=\"left: ${left}px; width: ${width}px;\" title=\"${m.title}\">${m.title}</div>`;\n        \n        // Use mousedown/up to distinguish between drag and click\n        let clickStartTime;\n        row.onmousedown = () => clickStartTime = Date.now();\n        row.onmouseup = () => {\n            if (Date.now() - clickStartTime < 200 && !isDragging) {\n                toggleMilestone(m.id);\n            }\n        };\n        \n        body.appendChild(row);\n    });\n}\n\nfunction initDrag() {\n    const slider = root.getElementById('gantt-view');\n    \n    slider.onmousedown = (e) => {\n        isDragging = true;\n        slider.classList.add('active');\n        startX = e.pageX - slider.offsetLeft;\n        scrollLeft = slider.scrollLeft;\n    };\n\n    slider.onmouseleave = () => {\n        isDragging = false;\n        slider.classList.remove('active');\n    };\n\n    slider.onmouseup = () => {\n        isDragging = false;\n        slider.classList.remove('active');\n    };\n\n    slider.onmousemove = (e) => {\n        if (!isDragging) return;\n        e.preventDefault();\n        const x = e.pageX - slider.offsetLeft;\n        const walk = (x - startX) * 2; // Scroll speed\n        slider.scrollLeft = scrollLeft - walk;\n    };\n}\n\nfunction toggleForm(show) {\n    const form = root.getElementById('milestone-form');\n    if (show) {\n        form.classList.add('show');\n        root.getElementById('input-title').focus();\n        if (!root.getElementById('input-start').value) {\n            const today = new Date().toISOString().split('T')[0];\n            root.getElementById('input-start').value = today;\n            root.getElementById('input-end').value = today;\n        }\n    } else {\n        form.classList.remove('show');\n        state.editingId = null;\n        root.getElementById('input-title').value = '';\n        root.getElementById('btn-save').innerText = 'Add';\n    }\n}\n\nfunction startEdit(id) {\n    const m = state.milestones.find(x => x.id === id);\n    if (!m) return;\n    \n    state.editingId = id;\n    root.getElementById('input-title').value = m.title;\n    root.getElementById('input-start').value = m.start;\n    root.getElementById('input-end').value = m.end;\n    root.getElementById('btn-save').innerText = 'Update';\n    toggleForm(true);\n}\n\nfunction saveMilestone() {\n    const title = root.getElementById('input-title').value.trim();\n    const start = root.getElementById('input-start').value;\n    const end = root.getElementById('input-end').value || start;\n    \n    if (!title || !start) return;\n\n    if (state.editingId) {\n        const idx = state.milestones.findIndex(x => x.id === state.editingId);\n        if (idx !== -1) {\n            state.milestones[idx].title = title;\n            state.milestones[idx].start = start;\n            state.milestones[idx].end = end;\n        }\n    } else {\n        state.milestones.push({ id: Date.now(), title, start, end, done: false });\n    }\n\n    toggleForm(false);\n    render();\n    saveState(state);\n}\n\nfunction toggleMilestone(id) {\n    const idx = state.milestones.findIndex(x => x.id === id);\n    if (idx !== -1) {\n        state.milestones[idx].done = !state.milestones[idx].done;\n        render();\n        saveState(state);\n    }\n}\n\nfunction deleteMilestone(id) {\n    state.milestones = state.milestones.filter(x => x.id !== id);\n    render();\n    saveState(state);\n}\n\nasync function init() {\n    const saved = await getState();\n    if (saved) Object.assign(state, saved);\n    \n    root.getElementById('btn-add-toggle').onclick = () => toggleForm(true);\n    root.getElementById('btn-cancel').onclick = () => toggleForm(false);\n    root.getElementById('btn-save').onclick = saveMilestone;\n    root.getElementById('btn-view-toggle').onclick = () => {\n        state.viewMode = state.viewMode === 'timeline' ? 'gantt' : 'timeline';\n        render();\n        saveState(state);\n    };\n    root.getElementById('btn-clear-all').onclick = () => {\n        if (confirm('Clear all?')) { state.milestones = []; render(); saveState(state); }\n    };\n    \n    const zoomInput = root.getElementById('input-zoom');\n    zoomInput.value = state.zoom || 40;\n    zoomInput.oninput = (e) => {\n        state.zoom = parseInt(e.target.value);\n        renderGantt();\n        saveState(state);\n    };\n\n    initDrag();\n    render();\n}\n\ninit();",
  "tags": [
    "productivity",
    "projects",
    "planning",
    "premium",
    "gantt",
    "zoom",
    "drag"
  ]
}
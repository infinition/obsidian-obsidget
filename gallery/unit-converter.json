{
  "id": "unit-converter",
  "name": "Unit Converter",
  "description": "Convert between various units of measurement.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"widget-card\">\n  <div class=\"widget-header\">\n    <h4 class=\"widget-title\">ğŸ”„ Universal Converter</h4>\n  </div>\n\n  \n  <div class=\"tabs\">\n    <button class=\"tab-btn active\" data-cat=\"length\" title=\"Length\">ğŸ“</button>\n    <button class=\"tab-btn\" data-cat=\"weight\" title=\"Weight\">âš–ï¸</button>\n    <button class=\"tab-btn\" data-cat=\"temp\" title=\"Temperature\">ğŸŒ¡ï¸</button>\n    <button class=\"tab-btn\" data-cat=\"speed\" title=\"Speed\">ğŸš€</button>\n  </div>\n\n  <div class=\"converter-box\">\n    \n    <div class=\"input-group\">\n      <input type=\"number\" id=\"val-a\" placeholder=\"0\">\n      <select id=\"unit-a\"></select>\n    </div>\n\n    \n    <div class=\"swap-container\">\n      <button id=\"btn-swap\" class=\"swap-btn\">â‡…</button>\n    </div>\n\n    \n    <div class=\"input-group\">\n      <input type=\"number\" id=\"val-b\" placeholder=\"0\">\n      <select id=\"unit-b\"></select>\n    </div>\n  </div>\n\n  <div class=\"footer\">\n    <span id=\"formula-display\">1 = 1</span>\n  </div>\n</div>",
  "css": ":host { display: block; margin: 1rem 0; font-family: var(--font-interface); } * { box-sizing: border-box; } .widget-card { background: var(--background-secondary); border: 1px solid var(--background-modifier-border); border-radius: 20px; padding: 1.5rem; box-shadow: var(--shadow-s); max-width: 380px; margin: 0 auto; transition: height 0.3s; } .widget-header { text-align: center; margin-bottom: 1rem; } .widget-title { margin: 0; font-size: 0.9rem; font-weight: 800; color: var(--text-normal); text-transform: uppercase; letter-spacing: 1px; } .tabs { display: flex; gap: 8px; justify-content: center; margin-bottom: 1.5rem; background: var(--background-primary); padding: 6px; border-radius: 12px; border: 1px solid var(--background-modifier-border); } .tab-btn { flex: 1; background: transparent; border: none; font-size: 1.2rem; cursor: pointer; padding: 8px; border-radius: 8px; transition: all 0.2s; opacity: 0.6; filter: grayscale(0.8); } .tab-btn:hover { opacity: 1; background: var(--background-modifier-hover); } .tab-btn.active { opacity: 1; filter: grayscale(0); background: var(--background-secondary); box-shadow: 0 2px 5px rgba(0,0,0,0.1); transform: scale(1.05); } .converter-box { display: flex; flex-direction: column; gap: 8px; position: relative; } .input-group { display: flex; background: var(--background-primary); border: 1px solid var(--background-modifier-border); border-radius: 12px; padding: 4px; transition: border-color 0.2s; } .input-group:focus-within { border-color: var(--interactive-accent); } .input-group input { flex: 1; background: transparent; border: none; font-size: 1.4rem; font-weight: 700; color: var(--text-normal); padding: 12px; width: 100px; outline: none; } .input-group select { background: var(--background-secondary); border: 1px solid var(--background-modifier-border); border-radius: 8px; padding: 0 12px; font-weight: 600; color: var(--text-muted); cursor: pointer; max-width: 120px; outline: none; } .swap-container { display: flex; justify-content: center; margin: -18px 0; z-index: 2; pointer-events: none; } .swap-btn { pointer-events: auto; width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--background-modifier-border); background: var(--background-secondary); color: var(--interactive-accent); font-size: 1.2rem; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.2s; box-shadow: var(--shadow-s); } .swap-btn:hover { transform: rotate(180deg) scale(1.1); color: var(--text-normal); } .footer { text-align: center; margin-top: 1rem; font-size: 0.8rem; color: var(--text-faint); font-family: var(--font-monospace); }",
  "js": "var root = api.root;\nvar saveState = api.saveState;\nvar getState = api.getState;\n\n// Configuration\nvar cats = {\n  length: {\n    base: 'm',\n    units: { m: 1, km: 1000, cm: 0.01, mm: 0.001, mi: 1609.34, yd: 0.9144, ft: 0.3048, in: 0.0254 }\n  },\n  weight: {\n    base: 'g',\n    units: { g: 1, kg: 1000, mg: 0.001, lb: 453.592, oz: 28.3495 }\n  },\n  speed: {\n    base: 'kph',\n    units: { kph: 1, mph: 1.60934, mps: 3.6, knot: 1.852 }\n  },\n  temp: {\n    type: 'func' // Special handling\n  }\n};\n\nvar state = {\n  cat: 'length',\n  valA: 1,\n  unitA: 'm',\n  unitB: 'km'\n};\n\nfunction tempConvert(val, from, to) {\n  if(from === to) return val;\n  var c = val;\n  // Convert to Celsius first\n  if(from === 'F') c = (val - 32) * 5/9;\n  if(from === 'K') c = val - 273.15;\n  // Convert from Celsius to Target\n  if(to === 'F') return (c * 9/5) + 32;\n  if(to === 'K') return c + 273.15;\n  return c;\n}\n\nfunction update(source) {\n  var catData = cats[state.cat];\n  var valA = parseFloat(root.getElementById('val-a').value);\n  var valB = parseFloat(root.getElementById('val-b').value);\n  \n  if(source === 'a') {\n     if(isNaN(valA)) { root.getElementById('val-b').value = ''; return; }\n     var res;\n     if(state.cat === 'temp') {\n        res = tempConvert(valA, state.unitA, state.unitB);\n     } else {\n        var base = valA * catData.units[state.unitA];\n        res = base / catData.units[state.unitB];\n     }\n     // Smart rounding\n     var str = res.toFixed(6).replace(/\\.0+$/, '').replace(/(\\.\\d*[1-9])0+$/, '$1');\n     if(Math.abs(res) > 10000 || (Math.abs(res) < 0.001 && res !== 0)) str = res.toExponential(4);\n     root.getElementById('val-b').value = str;\n     state.valA = valA;\n  } else {\n     if(isNaN(valB)) { root.getElementById('val-a').value = ''; return; }\n     var res;\n     if(state.cat === 'temp') {\n        res = tempConvert(valB, state.unitB, state.unitA);\n     } else {\n        var base = valB * catData.units[state.unitB];\n        res = base / catData.units[state.unitA];\n     }\n     var str = res.toFixed(6).replace(/\\.0+$/, '').replace(/(\\.\\d*[1-9])0+$/, '$1');\n     if(Math.abs(res) > 10000 || (Math.abs(res) < 0.001 && res !== 0)) str = res.toExponential(4);\n     root.getElementById('val-a').value = str;\n     state.valA = parseFloat(str);\n  }\n\n  // Footer Formula\n  root.getElementById('formula-display').innerText = '1 ' + state.unitA + ' = ' + calculateRatio() + ' ' + state.unitB;\n  saveState(state);\n}\n\nfunction calculateRatio() {\n    if(state.cat === 'temp') return '...';\n    var r = cats[state.cat].units[state.unitA] / cats[state.cat].units[state.unitB];\n    return r.toPrecision(4);\n}\n\nfunction populateSelects() {\n  var uA = root.getElementById('unit-a');\n  var uB = root.getElementById('unit-b');\n  uA.innerHTML = ''; uB.innerHTML = '';\n  \n  var units = [];\n  if(state.cat === 'temp') units = ['C', 'F', 'K'];\n  else units = Object.keys(cats[state.cat].units);\n  \n  units.forEach(function(u) {\n      var o1 = document.createElement('option'); o1.value = u; o1.innerText = u;\n      var o2 = document.createElement('option'); o2.value = u; o2.innerText = u;\n      uA.appendChild(o1);\n      uB.appendChild(o2);\n  });\n  \n  // Verify selection valid\n  if(units.indexOf(state.unitA) === -1) state.unitA = units[0];\n  if(units.indexOf(state.unitB) === -1) state.unitB = units[1] || units[0];\n  \n  uA.value = state.unitA;\n  uB.value = state.unitB;\n}\n\nfunction setCat(cat) {\n  state.cat = cat;\n  populateSelects();\n  // Reset values for cleanliness\n  root.getElementById('val-a').value = 1;\n  update('a');\n  \n  // UI Tabs\n  var tabs = root.querySelectorAll('.tab-btn');\n  tabs.forEach(function(t) {\n      if(t.getAttribute('data-cat') === cat) t.classList.add('active');\n      else t.classList.remove('active');\n  });\n}\n\nasync function init() {\n  var saved = await getState();\n  if(saved) Object.assign(state, saved);\n  \n  // Setup DOM\n  var tabs = root.querySelectorAll('.tab-btn');\n  tabs.forEach(function(t) {\n      t.onclick = function() { setCat(t.getAttribute('data-cat')); };\n  });\n\n  var uA = root.getElementById('unit-a');\n  var uB = root.getElementById('unit-b');\n  var vA = root.getElementById('val-a');\n  var vB = root.getElementById('val-b');\n  var swp = root.getElementById('btn-swap');\n\n  uA.onchange = function(e) { state.unitA = e.target.value; update('a'); };\n  uB.onchange = function(e) { state.unitB = e.target.value; update('a'); };\n  vA.oninput = function() { update('a'); };\n  vB.oninput = function() { update('b'); };\n  \n  swp.onclick = function() {\n      var temp = state.unitA;\n      state.unitA = state.unitB;\n      state.unitB = temp;\n      uA.value = state.unitA;\n      uB.value = state.unitB;\n      update('a');\n  };\n\n  setCat(state.cat);\n  if(state.valA) { vA.value = state.valA; update('a'); }\n}\n\ninit();",
  "tags": [
    "tools",
    "conversion",
    "calculator"
  ]
}
{
  "id": "timezone-scrubber",
  "name": "Timezone Scrubber",
  "description": "Keep track of time across different time zones.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"widget-card\">\n  <div class=\"widget-header\">\n    <div class=\"title-row\">\n      <span class=\"icon\">üåç</span>\n      <h4 class=\"widget-title\">World Scrubber</h4>\n    </div>\n    <div class=\"controls\">\n      <button id=\"btn-now\" class=\"btn-pill active\">LIVE</button>\n      <button id=\"btn-fmt\" class=\"btn-icon\">24h</button>\n    </div>\n  </div>\n\n  <div class=\"scrubber-section\">\n    <div class=\"main-time-display\">\n      <span id=\"local-time-display\">--:--</span>\n      <span id=\"local-ampm\" class=\"ampm\"></span>\n    </div>\n    <div class=\"slider-container\">\n      <span class=\"sun-icon\">‚òÄÔ∏è</span>\n      <input type=\"range\" id=\"time-slider\" min=\"0\" max=\"1439\" value=\"720\">\n      <span class=\"moon-icon\">üåô</span>\n    </div>\n    <div class=\"date-subtitle\" id=\"local-date\">Loading...</div>\n  </div>\n\n  <div class=\"cities-list\" id=\"cities-container\">\n  </div>\n</div>",
  "css": ":host { display: block; margin: 1rem 0; font-family: var(--font-interface); --h-accent: #38bdf8; --bg-card: var(--background-secondary); } * { box-sizing: border-box; } .widget-card { background: var(--bg-card); border: 1px solid var(--background-modifier-border); border-radius: 16px; padding: 1.25rem; box-shadow: var(--shadow-s); max-width: 380px; margin: 0 auto; } .widget-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; } .title-row { display: flex; align-items: center; gap: 8px; } .widget-title { margin: 0; font-size: 0.85rem; font-weight: 800; color: var(--text-normal); text-transform: uppercase; letter-spacing: 0.5px; } .controls { display: flex; gap: 8px; } .btn-pill { background: var(--background-modifier-border); border: none; color: var(--text-muted); padding: 4px 10px; border-radius: 100px; font-size: 0.7rem; font-weight: 700; cursor: pointer; transition: all 0.2s; } .btn-pill.active { background: var(--interactive-accent); color: var(--text-on-accent); } .btn-icon { background: transparent; border: 1px solid var(--background-modifier-border); color: var(--text-muted); width: 32px; height: 24px; border-radius: 6px; font-size: 0.7rem; cursor: pointer; } .btn-icon:hover { color: var(--text-normal); border-color: var(--text-muted); } .scrubber-section { text-align: center; margin-bottom: 1.5rem; padding: 1rem; background: var(--background-primary); border-radius: 12px; border: 1px solid var(--background-modifier-border); } .main-time-display { font-family: var(--font-monospace); font-size: 2.2rem; font-weight: 800; color: var(--h-accent); line-height: 1; margin-bottom: 0.5rem; } .ampm { font-size: 1rem; color: var(--text-muted); font-weight: 600; margin-left: 4px; } .slider-container { display: flex; align-items: center; gap: 10px; margin: 10px 0; } input[type=range] { -webkit-appearance: none; width: 100%; height: 6px; background: var(--background-modifier-border); border-radius: 5px; outline: none; cursor: pointer; } input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: var(--h-accent); cursor: pointer; transition: transform 0.1s; box-shadow: 0 0 10px rgba(56, 189, 248, 0.4); } input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); } .date-subtitle { font-size: 0.75rem; color: var(--text-faint); font-weight: 600; } .cities-list { display: grid; gap: 8px; } .city-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; border-radius: 8px; transition: background 0.2s; border-bottom: 1px solid transparent; } .city-row:hover { background: var(--background-modifier-hover); } .city-info { display: flex; align-items: center; gap: 10px; } .flag { font-size: 1.1rem; } .city-name { font-size: 0.85rem; font-weight: 600; color: var(--text-normal); } .city-time-group { text-align: right; } .city-time { font-family: var(--font-monospace); font-size: 0.95rem; font-weight: 700; color: var(--text-normal); } .city-meta { font-size: 0.7rem; color: var(--text-muted); display: flex; align-items: center; justify-content: flex-end; gap: 4px; } .diff-day { color: var(--interactive-accent); font-weight: 700; background: rgba(var(--interactive-accent-rgb), 0.1); padding: 0 4px; border-radius: 4px; }",
  "js": "var root = api.root;\nvar saveState = api.saveState;\nvar getState = api.getState;\n\nvar cities = [\n  { name: 'Los Angeles', zone: 'America/Los_Angeles', flag: 'üá∫üá∏' },\n  { name: 'New York', zone: 'America/New_York', flag: 'üá∫üá∏' },\n  { name: 'London', zone: 'Europe/London', flag: 'üá¨üáß' },\n  { name: 'Paris', zone: 'Europe/Paris', flag: 'üá´üá∑' },\n  { name: 'Tokyo', zone: 'Asia/Tokyo', flag: 'üáØüáµ' },\n  { name: 'Sydney', zone: 'Australia/Sydney', flag: 'üá¶üá∫' }\n];\n\nvar state = {\n  minutes: 720,\n  isLive: true,\n  is24h: true\n};\n\nvar liveInterval = null;\n\nfunction getFormattedTime(date, zone) {\n  var options = {\n    timeZone: zone,\n    hour: 'numeric',\n    minute: '2-digit',\n    hour12: !state.is24h\n  };\n  \n  var timeStr = new Intl.DateTimeFormat('en-US', options).format(date);\n  \n  // Day Diff Logic\n  var localParts = new Intl.DateTimeFormat('en-US', { \n      year:'numeric', month:'numeric', day:'numeric', \n      timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone \n  }).formatToParts(date);\n  \n  var targetParts = new Intl.DateTimeFormat('en-US', { \n      year:'numeric', month:'numeric', day:'numeric', hour:'numeric', timeZoneName: 'short',\n      timeZone: zone \n  }).formatToParts(date);\n  \n  var lDay = parseInt(localParts.find(function(p){ return p.type==='day'; }).value);\n  var tDay = parseInt(targetParts.find(function(p){ return p.type==='day'; }).value);\n  var tHour = parseInt(targetParts.find(function(p){ return p.type==='hour'; }).value);\n  var tAmPm = targetParts.find(function(p){ return p.type==='dayPeriod'; });\n  \n  var diff = 0;\n  if (tDay !== lDay) {\n      if (tDay === lDay + 1 || (lDay > 28 && tDay === 1)) diff = 1;\n      else diff = -1;\n  }\n\n  var hour24 = tHour;\n  if (tAmPm && tAmPm.value === 'PM' && tHour !== 12) hour24 += 12;\n  if (tAmPm && tAmPm.value === 'AM' && tHour === 12) hour24 = 0;\n  \n  var isNight = (hour24 < 6 || hour24 >= 18);\n  var tzName = targetParts.find(function(p){ return p.type==='timeZoneName'; });\n  var abbr = tzName ? tzName.value : '';\n\n  return { timeStr: timeStr, diff: diff, isNight: isNight, abbr: abbr };\n}\n\nfunction renderCities(baseDate) {\n    var container = root.getElementById('cities-container');\n    container.innerHTML = '';\n\n    cities.forEach(function(city) {\n        var data = getFormattedTime(baseDate, city.zone);\n        var diffHtml = '';\n        if (data.diff !== 0) {\n            var txt = data.diff > 0 ? '+1' : '-1';\n            diffHtml = '<span class=\"diff-day\">' + txt + ' Day</span>';\n        }\n\n        var icon = data.isNight ? 'üåô' : '‚òÄÔ∏è';\n        \n        var div = document.createElement('div');\n        div.className = 'city-row';\n        div.innerHTML = \n            '<div class=\"city-info\">' +\n                '<span class=\"flag\">' + city.flag + '</span>' +\n                '<div><div class=\"city-name\">' + city.name + '</div></div>' +\n            '</div>' +\n            '<div class=\"city-time-group\">' +\n                '<div class=\"city-time\">' + data.timeStr + '</div>' +\n                '<div class=\"city-meta\">' + icon + ' ' + diffHtml + ' ' + data.abbr + '</div>' +\n            '</div>';\n        container.appendChild(div);\n    });\n}\n\nfunction updateUI() {\n    var now = new Date();\n    var baseDate = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0, 0, 0, 0);\n    baseDate.setMinutes(state.minutes);\n\n    var localData = getFormattedTime(baseDate, Intl.DateTimeFormat().resolvedOptions().timeZone);\n    var parts = localData.timeStr.split(' ');\n    \n    var displayEl = root.getElementById('local-time-display');\n    var ampmEl = root.getElementById('local-ampm');\n    var dateEl = root.getElementById('local-date');\n    \n    if(displayEl) displayEl.innerText = parts[0];\n    if(ampmEl) ampmEl.innerText = parts[1] || '';\n    if(dateEl) dateEl.innerText = baseDate.toLocaleDateString(undefined, { weekday: 'long', month: 'short', day: 'numeric' });\n    \n    var slider = root.getElementById('time-slider');\n    if (slider && document.activeElement !== slider) {\n        slider.value = state.minutes;\n    }\n\n    renderCities(baseDate);\n    \n    var btnNow = root.getElementById('btn-now');\n    var btnFmt = root.getElementById('btn-fmt');\n    if(btnNow) {\n        if(state.isLive) btnNow.classList.add('active');\n        else btnNow.classList.remove('active');\n    }\n    if(btnFmt) btnFmt.innerText = state.is24h ? '24h' : '12h';\n}\n\nfunction setLiveMode(isLive) {\n    state.isLive = isLive;\n    if (isLive) {\n        updateFromRealTime();\n        if(!liveInterval) liveInterval = setInterval(updateFromRealTime, 10000);\n    } else {\n        if(liveInterval) clearInterval(liveInterval);\n        liveInterval = null;\n    }\n    updateUI();\n}\n\nfunction updateFromRealTime() {\n    var now = new Date();\n    state.minutes = (now.getHours() * 60) + now.getMinutes();\n    updateUI();\n}\n\nasync function init() {\n    var saved = await getState();\n    if (saved) {\n        state.is24h = saved.is24h !== undefined ? saved.is24h : true;\n    }\n\n    var slider = root.getElementById('time-slider');\n    if(slider) {\n        slider.oninput = function(e) {\n            state.minutes = parseInt(e.target.value);\n            if (state.isLive) setLiveMode(false);\n            updateUI();\n        };\n        slider.onchange = function() {\n            saveState({ is24h: state.is24h });\n        };\n    }\n\n    var btnNow = root.getElementById('btn-now');\n    if(btnNow) btnNow.onclick = function() { setLiveMode(true); };\n\n    var btnFmt = root.getElementById('btn-fmt');\n    if(btnFmt) btnFmt.onclick = function() {\n        state.is24h = !state.is24h;\n        saveState({ is24h: state.is24h });\n        updateUI();\n    };\n\n    setLiveMode(true);\n}\n\ninit();",
  "tags": [
    "time",
    "converter",
    "travel"
  ]
}
export default {
    "id": "vault-gardener",
    "name": "The Gardener",
    "description": "Maintenance gamifiÃ©e. Identifiez et nettoyez vos notes orphelines (0 backlinks) une par une.",
    "author": "Infinition",
    "defaultSizePx": { "width": 300, "height": 450 },
    "html": "<div class=\"gardener-wrapper\" id=\"gardener-root\">\n  <div class=\"gardener-header\">\n    <span class=\"header-icon\">ðŸŒ¿</span>\n    <div class=\"header-info\">\n      <div class=\"header-title\">THE GARDENER</div>\n      <div class=\"header-subtitle\"><span id=\"orphan-count\">0</span> feuilles mortes</div>\n    </div>\n    <button class=\"refresh-btn\" id=\"btn-refresh\" title=\"Rescan\">\n      <svg viewBox=\"0 0 24 24\" width=\"16\" height=\"16\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"23 4 23 10 17 10\"></polyline><path d=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\"></path></svg>\n    </button>\n  </div>\n\n  <div class=\"cards-stage\" id=\"cards-stage\">\n    <div id=\"empty-state\" class=\"empty-state\" style=\"display:none\">\n      <div class=\"empty-icon\">âœ¨</div>\n      <div>Jardin propre !</div>\n    </div>\n    \n  </div>\n\n  <div class=\"controls\">\n    <button class=\"action-btn delete\" id=\"btn-trash\" title=\"Mettre Ã  la corbeille\">\n      <svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"3 6 5 6 21 6\"></polyline><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path></svg>\n    </button>\n    <button class=\"action-btn keep\" id=\"btn-keep\" title=\"Garder pour plus tard\">\n      <svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"20 6 9 17 4 12\"></polyline></svg>\n    </button>\n  </div>\n</div>",
    "css": ":host { --gd-bg: var(--background-primary); --gd-card: var(--background-secondary); --gd-red: #ef4444; --gd-green: #22c55e; --gd-shadow: var(--shadow-l); display: flex; flex-direction: column; width: 100%; height: 100%; overflow: hidden; font-family: var(--font-interface); }\n\n.gardener-wrapper { flex: 1; display: flex; flex-direction: column; background: var(--gd-bg); position: relative; }\n\n.gardener-header { padding: 16px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid var(--background-modifier-border); }\n.header-icon { font-size: 1.5rem; }\n.header-title { font-weight: 800; font-size: 0.9rem; letter-spacing: 1px; color: var(--text-normal); }\n.header-subtitle { font-size: 0.7rem; color: var(--text-muted); }\n.refresh-btn { margin-left: auto; background: none; border: none; color: var(--text-muted); cursor: pointer; padding: 4px; border-radius: 4px; }\n.refresh-btn:hover { background: var(--background-modifier-hover); color: var(--text-normal); }\n\n.cards-stage { flex: 1; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; perspective: 1000px; }\n\n.card { position: absolute; width: 80%; height: 70%; background: var(--gd-card); border-radius: 16px; border: 1px solid var(--background-modifier-border); padding: 20px; box-shadow: var(--gd-shadow); display: flex; flex-direction: column; transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1), opacity 0.3s; cursor: pointer; user-select: none; }\n.card:hover { transform: scale(1.02); border-color: var(--interactive-accent); }\n.card.top { z-index: 10; }\n.card.under { z-index: 5; transform: scale(0.95) translateY(10px); opacity: 0.6; pointer-events: none; }\n\n/* Animations Swipe */\n.card.swipe-left { transform: translateX(-150%) rotate(-20deg); opacity: 0; }\n.card.swipe-right { transform: translateX(150%) rotate(20deg); opacity: 0; }\n\n.card-title { font-size: 1.1rem; font-weight: 700; color: var(--text-normal); margin-bottom: 8px; line-height: 1.3; }\n.card-preview { font-size: 0.8rem; color: var(--text-muted); flex: 1; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 8; -webkit-box-orient: vertical; }\n\n.empty-state { text-align: center; color: var(--text-muted); font-weight: 600; }\n.empty-icon { font-size: 3rem; margin-bottom: 10px; }\n\n.controls { height: 80px; display: flex; align-items: center; justify-content: center; gap: 40px; padding-bottom: 10px; }\n.action-btn { width: 56px; height: 56px; border-radius: 50%; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.1s, background 0.2s; box-shadow: var(--shadow-s); }\n.action-btn:active { transform: scale(0.9); }\n.action-btn.delete { background: var(--background-primary-alt); color: var(--gd-red); border: 2px solid var(--gd-red); }\n.action-btn.delete:hover { background: var(--gd-red); color: white; }\n.action-btn.keep { background: var(--background-primary-alt); color: var(--gd-green); border: 2px solid var(--gd-green); }\n.action-btn.keep:hover { background: var(--gd-green); color: white; }",
    "js": "var root = api.root;\nvar app = window.app || api.app;\n\nvar orphans = [];\nvar currentIndex = 0;\n\nfunction qs(sel) { return root.querySelector(sel); }\n\nfunction findOrphans() {\n  if(!app) return;\n  var files = app.vault.getFiles();\n  var links = app.metadataCache.resolvedLinks;\n  \n  // Build Backlinks Map\n  var backlinks = {};\n  for (var src in links) {\n    for (var dest in links[src]) {\n      if (!backlinks[dest]) backlinks[dest] = 0;\n      backlinks[dest]++;\n    }\n  }\n  \n  orphans = files.filter(f => {\n    if (f.extension !== 'md') return false;\n    // Orphan = No backlinks AND No Outlinks (Strict) or Just No Backlinks?\n    // Let's do: No Backlinks (files referencing it) to start simple.\n    var bl = backlinks[f.path] || 0;\n    // Filter out Daily Notes usually?\n    return bl === 0;\n  });\n  \n  // Shuffle\n  orphans.sort(() => Math.random() - 0.5);\n  \n  qs('#orphan-count').textContent = orphans.length;\n  currentIndex = 0;\n  renderCards();\n}\n\nfunction renderCards() {\n  var stage = qs('#cards-stage');\n  var empty = qs('#empty-state');\n  // Clear old cards except empty state\n  Array.from(stage.querySelectorAll('.card')).forEach(c => c.remove());\n  \n  if (currentIndex >= orphans.length) {\n    empty.style.display = 'block';\n    return;\n  }\n  empty.style.display = 'none';\n\n  // Render Top Card\n  var card = createCard(orphans[currentIndex]);\n  card.classList.add('top');\n  stage.appendChild(card);\n\n  // Render Next Card (Preview)\n  if (currentIndex + 1 < orphans.length) {\n    var next = createCard(orphans[currentIndex + 1]);\n    next.classList.add('under');\n    stage.appendChild(next);\n  }\n}\n\nfunction createCard(file) {\n  var el = document.createElement('div');\n  el.className = 'card';\n  // Simple content preview\n  var cache = app.metadataCache.getFileCache(file);\n  var content = \"(Note vide)\";\n  // Async read for preview is tricky in sync UI generation, \n  // but we can assume user clicks to read full content.\n  // We'll show title and path.\n  \n  el.innerHTML = `\n    <div class=\"card-title\">${file.basename}</div>\n    <div class=\"card-preview\">${file.path}<br><br>Cliquez pour ouvrir et Ã©diter cette note orpheline.</div>\n  `;\n  \n  el.onclick = () => app.workspace.openLinkText(file.path, '', true);\n  return el;\n}\n\nfunction swipe(dir) {\n  var top = qs('.card.top');\n  if (!top) return;\n  \n  top.classList.add(dir === 'left' ? 'swipe-left' : 'swipe-right');\n  \n  setTimeout(() => {\n    if (dir === 'left') {\n      // Delete logic\n      var file = orphans[currentIndex];\n      app.vault.trash(file, true); // true = System trash, false = Obsidian trash\n    }\n    // Keep logic = just do nothing, move index\n    \n    currentIndex++;\n    renderCards();\n  }, 250);\n}\n\nfunction init() {\n  qs('#btn-refresh').onclick = findOrphans;\n  qs('#btn-trash').onclick = () => swipe('left');\n  qs('#btn-keep').onclick = () => swipe('right');\n  \n  setTimeout(findOrphans, 500);\n}\n\ninit();",
    "tags": ["maintenance", "gamification", "cleaner", "tinder", "organization"]
  };
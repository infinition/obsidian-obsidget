{
  "id": "ai-token-studio",
  "name": "AI Token Studio",
  "description": "AI token and cost estimator for various models.",
  "author": "Infinition",
  "authorUrl": "https://github.com/infinition",
  "html": "<div class=\"widget-card\">\n  <div class=\"widget-header\">\n    <div class=\"header-left\">\n      <span class=\"icon\">üíé</span>\n      <h4 class=\"widget-title\">AI Cost Studio</h4>\n    </div>\n    <div class=\"header-right\">\n      <button id=\"btn-settings\" class=\"icon-btn\" title=\"Custom Pricing\">‚öôÔ∏è</button>\n      <div class=\"total-badge\">$<span id=\"total-cost\">0.0000</span></div>\n    </div>\n  </div>\n\n  \n  <div id=\"settings-panel\" class=\"settings-overlay hidden\">\n    <div class=\"settings-content\">\n      <h5>Custom Model Pricing</h5>\n      <div class=\"setting-row\">\n        <label>Input Price ($/1M)</label>\n        <input type=\"number\" id=\"set-input-price\" step=\"0.1\">\n      </div>\n      <div class=\"setting-row\">\n        <label>Output Price ($/1M)</label>\n        <input type=\"number\" id=\"set-output-price\" step=\"0.1\">\n      </div>\n      <button id=\"btn-save-settings\" class=\"btn-primary\">Apply Custom</button>\n    </div>\n  </div>\n\n  \n  <div class=\"input-container\">\n    <textarea id=\"prompt-input\" placeholder=\"Paste your prompt here to calculate magic...\"></textarea>\n    <div class=\"char-count\"><span id=\"char-val\">0</span> chars</div>\n  </div>\n\n  \n  <div class=\"simulation-section\">\n    <div class=\"sim-header\">\n      <label>Expected Response Length</label>\n      <span id=\"output-val\">500 tokens</span>\n    </div>\n    <input type=\"range\" id=\"output-slider\" min=\"0\" max=\"4000\" step=\"50\" value=\"500\">\n  </div>\n\n  \n  <div class=\"stats-grid\">\n    <div class=\"stat-card\">\n      <span class=\"stat-label\">Input Tokens</span>\n      <span class=\"stat-value\" id=\"input-tokens\">0</span>\n    </div>\n    <div class=\"stat-card\">\n      <span class=\"stat-label\">Total Tokens</span>\n      <span class=\"stat-value accent\" id=\"total-tokens\">0</span>\n    </div>\n  </div>\n\n  \n  <div class=\"model-selector\">\n    <button class=\"model-btn active\" data-model=\"gpt4o\">GPT-4o</button>\n    <button class=\"model-btn\" data-model=\"mini\">Mini</button>\n    <button class=\"model-btn\" data-model=\"claude\">Claude 3.5</button>\n    <button class=\"model-btn\" data-model=\"llama\">Llama 3</button>\n  </div>\n\n  \n  <div class=\"context-bar-container\">\n    <div class=\"context-label\">Context Window Usage (128k)</div>\n    <div class=\"context-bar-bg\">\n      <div class=\"context-bar-fill\" id=\"context-fill\"></div>\n    </div>\n  </div>\n</div>",
  "css": ":host { display: block; margin: 1rem 0; font-family: var(--font-interface); } * { box-sizing: border-box; } .widget-card { background: var(--background-secondary); border: 1px solid var(--background-modifier-border); border-radius: 16px; padding: 1.5rem; box-shadow: var(--shadow-s); max-width: 450px; margin: 0 auto; position: relative; overflow: hidden; } .widget-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; } .header-left { display: flex; align-items: center; gap: 8px; } .widget-title { margin: 0; font-size: 0.9rem; font-weight: 800; color: var(--text-normal); text-transform: uppercase; letter-spacing: 0.5px; } .icon-btn { background: transparent; border: none; cursor: pointer; opacity: 0.6; font-size: 1.1rem; } .icon-btn:hover { opacity: 1; } .total-badge { background: rgba(var(--interactive-accent-rgb), 0.15); color: var(--interactive-accent); padding: 4px 10px; border-radius: 8px; font-weight: 800; font-family: var(--font-monospace); font-size: 1rem; border: 1px solid rgba(var(--interactive-accent-rgb), 0.3); } .input-container { position: relative; margin-bottom: 1rem; } textarea { width: 100%; height: 120px; background: var(--background-primary); color: var(--text-normal); border: 1px solid var(--background-modifier-border); border-radius: 12px; padding: 12px; font-size: 0.9rem; outline: none; resize: vertical; transition: border-color 0.2s; font-family: var(--font-monospace); } textarea:focus { border-color: var(--interactive-accent); } .char-count { position: absolute; bottom: 8px; right: 12px; font-size: 0.7rem; color: var(--text-muted); pointer-events: none; } .simulation-section { margin-bottom: 1.5rem; background: var(--background-primary-alt); padding: 10px; border-radius: 10px; border: 1px solid var(--background-modifier-border); } .sim-header { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 0.75rem; font-weight: 700; color: var(--text-muted); } input[type=range] { width: 100%; height: 4px; border-radius: 2px; -webkit-appearance: none; background: var(--background-modifier-border); outline: none; } input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; width: 16px; height: 16px; border-radius: 50%; background: var(--interactive-accent); cursor: pointer; transition: transform 0.1s; } input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.2); } .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 1rem; } .stat-card { background: var(--background-primary); padding: 10px; border-radius: 10px; text-align: center; border: 1px solid var(--background-modifier-border); } .stat-label { display: block; font-size: 0.65rem; text-transform: uppercase; color: var(--text-muted); font-weight: 700; margin-bottom: 4px; } .stat-value { font-size: 1.1rem; font-weight: 800; color: var(--text-normal); font-family: var(--font-monospace); } .stat-value.accent { color: var(--interactive-accent); } .model-selector { display: flex; gap: 4px; margin-bottom: 1.5rem; background: var(--background-primary); padding: 4px; border-radius: 8px; border: 1px solid var(--background-modifier-border); } .model-btn { flex: 1; background: transparent; border: none; padding: 6px; font-size: 0.7rem; font-weight: 700; color: var(--text-muted); cursor: pointer; border-radius: 6px; transition: all 0.2s; } .model-btn.active { background: var(--background-secondary); color: var(--text-normal); box-shadow: 0 1px 3px rgba(0,0,0,0.1); } .context-bar-container { margin-top: 1rem; } .context-label { font-size: 0.65rem; color: var(--text-faint); margin-bottom: 4px; text-align: right; } .context-bar-bg { height: 6px; background: var(--background-modifier-border); border-radius: 3px; overflow: hidden; } .context-bar-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--interactive-accent), #a78bfa); transition: width 0.3s ease; } .settings-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); z-index: 10; display: flex; align-items: center; justify-content: center; opacity: 0; pointer-events: none; transition: opacity 0.2s; } .settings-overlay:not(.hidden) { opacity: 1; pointer-events: all; } .settings-content { background: var(--background-primary); padding: 1.5rem; border-radius: 12px; width: 85%; border: 1px solid var(--background-modifier-border); } .settings-content h5 { margin: 0 0 1rem 0; text-align: center; } .setting-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.9rem; align-items: center; } .setting-row input { width: 80px; background: var(--background-secondary); border: 1px solid var(--background-modifier-border); padding: 4px; border-radius: 4px; color: var(--text-normal); text-align: right; } .btn-primary { width: 100%; background: var(--interactive-accent); color: white; border: none; padding: 8px; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; }",
  "js": "var root = api.root;\nvar saveState = api.saveState;\nvar getState = api.getState;\n\n// Prices per 1M tokens (Input / Output)\nvar presets = {\n  gpt4o: { in: 5.00, out: 15.00 },\n  mini: { in: 0.15, out: 0.60 },\n  claude: { in: 3.00, out: 15.00 },\n  llama: { in: 0.10, out: 0.10 }, // generic cheap\n  custom: { in: 0, out: 0 }\n};\n\nvar state = {\n  text: '',\n  model: 'gpt4o',\n  outputTokens: 500,\n  customPrice: { in: 5, out: 15 }\n};\n\nfunction estimateTokens(str) {\n  if(!str) return 0;\n  // Improved approximation: Words * 1.3 is standard for English\n  // Using regex to count word-like groups\n  var words = str.trim().split(/\\s+/).length;\n  var chars = str.length;\n  // Hybrid formula for code/text mix\n  return Math.ceil(Math.max(words * 1.33, chars / 4));\n}\n\nfunction update() {\n  var inTokens = estimateTokens(state.text);\n  var outTokens = parseInt(state.outputTokens);\n  var totalTokens = inTokens + outTokens;\n  \n  // Pricing\n  var pricing = (state.model === 'custom') ? state.customPrice : presets[state.model];\n  var cost = ((inTokens / 1000000) * pricing.in) + ((outTokens / 1000000) * pricing.out);\n\n  // Update UI Stats\n  root.getElementById('input-tokens').innerText = inTokens.toLocaleString();\n  root.getElementById('total-tokens').innerText = totalTokens.toLocaleString();\n  root.getElementById('total-cost').innerText = cost.toFixed(4);\n  root.getElementById('char-val').innerText = state.text.length;\n  \n  // Update Slider Label\n  root.getElementById('output-val').innerText = outTokens + ' tokens';\n\n  // Update Context Bar (Assuming 128k window)\n  var ctxPct = (totalTokens / 128000) * 100;\n  root.getElementById('context-fill').style.width = Math.min(100, Math.max(1, ctxPct)) + '%';\n}\n\nfunction setupModelBtns() {\n  var btns = root.querySelectorAll('.model-btn');\n  btns.forEach(function(btn) {\n    btn.onclick = function() {\n      btns.forEach(function(b){ b.classList.remove('active'); });\n      btn.classList.add('active');\n      state.model = btn.getAttribute('data-model');\n      update();\n      saveState(state);\n    };\n  });\n}\n\nfunction toggleSettings(show) {\n  var el = root.getElementById('settings-panel');\n  if(show) {\n      el.classList.remove('hidden');\n      // Load current pricing into inputs if custom, else load selected preset to edit\n      var currentP = (state.model === 'custom') ? state.customPrice : presets[state.model];\n      root.getElementById('set-input-price').value = currentP.in;\n      root.getElementById('set-output-price').value = currentP.out;\n  } else {\n      el.classList.add('hidden');\n  }\n}\n\nasync function init() {\n  var saved = await getState();\n  if (saved) Object.assign(state, saved);\n\n  // Restore Input\n  var input = root.getElementById('prompt-input');\n  input.value = state.text;\n  \n  // Restore Slider\n  var slider = root.getElementById('output-slider');\n  slider.value = state.outputTokens;\n\n  // Restore Model UI\n  var btns = root.querySelectorAll('.model-btn');\n  btns.forEach(function(b) {\n      if(b.getAttribute('data-model') === state.model) b.classList.add('active');\n      else b.classList.remove('active');\n  });\n\n  // Listeners\n  input.oninput = function(e) {\n      state.text = e.target.value;\n      update();\n      saveState(state);\n  };\n\n  slider.oninput = function(e) {\n      state.outputTokens = e.target.value;\n      update();\n      saveState(state);\n  };\n\n  root.getElementById('btn-settings').onclick = function() { toggleSettings(true); };\n  \n  root.getElementById('btn-save-settings').onclick = function() {\n      state.model = 'custom';\n      state.customPrice.in = parseFloat(root.getElementById('set-input-price').value) || 0;\n      state.customPrice.out = parseFloat(root.getElementById('set-output-price').value) || 0;\n      \n      // Visually deselect presets\n      btns.forEach(function(b){ b.classList.remove('active'); });\n      \n      toggleSettings(false);\n      update();\n      saveState(state);\n  };\n\n  setupModelBtns();\n  update();\n}\n\ninit();",
  "tags": [
    "ai",
    "tools",
    "estimator",
    "cost"
  ]
}